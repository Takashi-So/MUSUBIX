# MUSUBIX v2.2.0 ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¬ã‚¤ãƒ‰

**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 2.2.0  
**æœ€çµ‚æ›´æ–°**: 2026-01-09  
**å¯¾è±¡**: é–‹ç™ºè€…ã€AIã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ

---

## ç›®æ¬¡

1. [ã¯ã˜ã‚ã«](#1-ã¯ã˜ã‚ã«)
2. [ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«](#2-ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«)
3. [Phase 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–](#3-phase-1-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–)
4. [Phase 2: è¦ä»¶å®šç¾©ï¼ˆEARSå½¢å¼ï¼‰](#4-phase-2-è¦ä»¶å®šç¾©earså½¢å¼)
5. [Phase 3: è¨­è¨ˆï¼ˆC4ãƒ¢ãƒ‡ãƒ«ï¼‰](#5-phase-3-è¨­è¨ˆc4ãƒ¢ãƒ‡ãƒ«)
6. [Phase 4: ã‚¿ã‚¹ã‚¯åˆ†è§£](#6-phase-4-ã‚¿ã‚¹ã‚¯åˆ†è§£)
7. [Phase 5: ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ](#7-phase-5-ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ)
8. [Phase 6: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ](#8-phase-6-ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ)
9. [Phase 7: å½¢å¼æ¤œè¨¼](#9-phase-7-å½¢å¼æ¤œè¨¼)
10. [Phase 8: ãƒ†ã‚¹ãƒˆç”Ÿæˆ](#10-phase-8-ãƒ†ã‚¹ãƒˆç”Ÿæˆ)
11. [Phase 9: ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£](#11-phase-9-ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£)
12. [é«˜åº¦ãªæ©Ÿèƒ½ï¼ˆv2.2.0ï¼‰](#12-é«˜åº¦ãªæ©Ÿèƒ½v220)
13. [ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚µãƒãƒªãƒ¼](#13-ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚µãƒãƒªãƒ¼)
14. [ãã®ä»–ã®æ©Ÿèƒ½](#14-ãã®ä»–ã®æ©Ÿèƒ½)
- [ä»˜éŒ²A: 9æ¡æ†²æ³•](#ä»˜éŒ²a-9æ¡æ†²æ³•)
- [ä»˜éŒ²B: CLIã‚³ãƒãƒ³ãƒ‰ä¸€è¦§](#ä»˜éŒ²b-cliã‚³ãƒãƒ³ãƒ‰ä¸€è¦§)
- [ä»˜éŒ²C: ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ](#ä»˜éŒ²c-ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ)
- [ä»˜éŒ²D: EARSãƒ‘ã‚¿ãƒ¼ãƒ³æ—©è¦‹è¡¨](#ä»˜éŒ²d-earsãƒ‘ã‚¿ãƒ¼ãƒ³æ—©è¦‹è¡¨)

---

## 1. ã¯ã˜ã‚ã«

### 1.1 MUSUBIXã¨ã¯

**MUSUBIX**ï¼ˆãƒ ã‚¹ãƒ“ãƒƒã‚¯ã‚¹ï¼‰ã¯ã€**Neuro-Symbolic AIçµ±åˆã‚·ã‚¹ãƒ†ãƒ **ã§ã™ã€‚LLMï¼ˆå¤§è¦æ¨¡è¨€èªãƒ¢ãƒ‡ãƒ«ï¼‰ã®å‰µé€ æ€§ã¨ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯æ¨è«–ã®ç²¾å¯†æ€§ã‚’èåˆã—ã€é«˜å“è³ªãªã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºã‚’æ”¯æ´ã—ã¾ã™ã€‚

### 1.2 ä¸»è¦ãªç‰¹å¾´

| ç‰¹å¾´ | èª¬æ˜ |
|------|------|
| **EARSå½¢å¼è¦ä»¶** | å½¢å¼çš„ãªè¦ä»¶è¨˜è¿°ï¼ˆ5ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰ |
| **C4ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ** | 4ãƒ¬ãƒ™ãƒ«ã®ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£è¨­è¨ˆ |
| **9æ¡æ†²æ³•** | é–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã‚’çµ±æ²»ã™ã‚‹ä¸å¤‰ãƒ«ãƒ¼ãƒ« |
| **å®Œå…¨ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£** | è¦ä»¶â†’è¨­è¨ˆâ†’ã‚³ãƒ¼ãƒ‰â†’ãƒ†ã‚¹ãƒˆã®100%è¿½è·¡ |
| **å½¢å¼æ¤œè¨¼** | Z3 SMTã‚½ãƒ«ãƒã«ã‚ˆã‚‹æ•°å­¦çš„æ¤œè¨¼ |
| **ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ** | OWASP Top 10/CWE Top 25å¯¾å¿œ |
| **è‡ªå·±å­¦ç¿’** | ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’ã¨é©å¿œçš„æ¨è«– |

### 1.3 ã“ã®ã‚¬ã‚¤ãƒ‰ã«ã¤ã„ã¦

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€**Medical Appointment Systemï¼ˆåŒ»ç™‚äºˆç´„ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ï¼‰** ã‚’é¡Œæã«ã€MUSUBIXã®å…¨æ©Ÿèƒ½ã‚’ä½¿ã£ãŸé–‹ç™ºãƒ—ãƒ­ã‚»ã‚¹ã‚’å®Ÿæ¼”ã—ã¾ã™ã€‚

---

## 2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

### 2.1 npmã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
# å…¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä¸€æ‹¬ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
npm install musubix

# ã¾ãŸã¯å€‹åˆ¥ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸
npm install @nahisaho/musubix-core
```

### 2.2 ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶

| é …ç›® | è¦ä»¶ |
|------|------|
| Node.js | >= 20.0.0 |
| npm | >= 10.0.0 |
| OS | Windows, macOS, Linux |

### 2.3 ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª

```bash
npx musubix --version
# å‡ºåŠ›: 2.2.0
```

---

## 3. Phase 1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ–

### 3.1 `musubix init` ã‚³ãƒãƒ³ãƒ‰

MUSUBIXãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚

```bash
npx musubix init medical-appointment-system --name "Medical Appointment System"
```

### 3.2 å®Ÿè¡Œçµæœ

```json
{
  "success": true,
  "projectPath": "/tmp/medical-appointment-system",
  "filesCreated": [
    "steering/",
    "steering/rules/",
    "storage/",
    "storage/specs/",
    "storage/archive/",
    "storage/changes/",
    ".github/",
    ".github/prompts/",
    ".github/skills/",
    "musubix.config.json",
    "steering/rules/constitution.md",
    "steering/product.md",
    "steering/tech.md",
    "steering/structure.md",
    "AGENTS.md"
  ],
  "message": "MUSUBIX project 'Medical Appointment System' initialized successfully!"
}
```

### 3.3 ç”Ÿæˆã•ã‚Œã‚‹ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
medical-appointment-system/
â”œâ”€â”€ steering/                 # ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ¢ãƒª
â”‚   â”œâ”€â”€ rules/
â”‚   â”‚   â””â”€â”€ constitution.md   # 9æ¡æ†²æ³•
â”‚   â”œâ”€â”€ product.md            # ãƒ—ãƒ­ãƒ€ã‚¯ãƒˆã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆ
â”‚   â”œâ”€â”€ tech.md               # æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯
â”‚   â””â”€â”€ structure.md          # ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ãƒ‘ã‚¿ãƒ¼ãƒ³
â”œâ”€â”€ storage/                  # æˆæœç‰©ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
â”‚   â”œâ”€â”€ specs/                # è¦ä»¶ãƒ»è¨­è¨ˆãƒ»ã‚¿ã‚¹ã‚¯
â”‚   â”œâ”€â”€ archive/              # ã‚¢ãƒ¼ã‚«ã‚¤ãƒ–
â”‚   â””â”€â”€ changes/              # å¤‰æ›´å±¥æ­´
â”œâ”€â”€ .github/
â”‚   â”œâ”€â”€ prompts/              # AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆç”¨ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
â”‚   â””â”€â”€ skills/               # AIã‚¹ã‚­ãƒ«å®šç¾©
â”œâ”€â”€ musubix.config.json       # è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
â””â”€â”€ AGENTS.md                 # AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆå‘ã‘ã‚¬ã‚¤ãƒ‰
```

### 3.4 MUSUBIXã®å‡¦ç†å†…å®¹

`musubix init` ã¯ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

1. **ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä½œæˆ** - SDDæ–¹æ³•è«–ã«æº–æ‹ ã—ãŸãƒ•ã‚©ãƒ«ãƒ€æ§‹é€ 
2. **9æ¡æ†²æ³•ã®é…ç½®** - é–‹ç™ºãƒ«ãƒ¼ãƒ«ã‚’ `steering/rules/constitution.md` ã«ç”Ÿæˆ
3. **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ¡ãƒ¢ãƒªã®åˆæœŸåŒ–** - AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒå‚ç…§ã™ã‚‹è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
4. **AIã‚¹ã‚­ãƒ«ã®é…ç½®** - GitHub Copilot/Claudeç”¨ã®ã‚¹ã‚­ãƒ«å®šç¾©

---

## 4. Phase 2: è¦ä»¶å®šç¾©ï¼ˆEARSå½¢å¼ï¼‰

### 4.1 EARSå½¢å¼ã¨ã¯

**EARS (Easy Approach to Requirements Syntax)** ã¯ã€è‡ªç„¶è¨€èªã®æ›–æ˜§ã•ã‚’æ’é™¤ã—ãŸå½¢å¼çš„ãªè¦ä»¶è¨˜è¿°æ–¹æ³•ã§ã™ã€‚

### 4.2 5ã¤ã®EARSãƒ‘ã‚¿ãƒ¼ãƒ³

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | æ§‹æ–‡ | ç”¨é€” |
|---------|------|------|
| **Ubiquitous** | `THE [system] SHALL [requirement]` | å¸¸ã«æº€ãŸã™ã¹ãè¦ä»¶ |
| **Event-driven** | `WHEN [event], THE [system] SHALL [response]` | ã‚¤ãƒ™ãƒ³ãƒˆç™ºç”Ÿæ™‚ã®è¦ä»¶ |
| **State-driven** | `WHILE [state], THE [system] SHALL [response]` | ç‰¹å®šçŠ¶æ…‹ã§ã®è¦ä»¶ |
| **Unwanted** | `THE [system] SHALL NOT [behavior]` | ç¦æ­¢å‹•ä½œ |
| **Optional** | `IF [condition], THEN THE [system] SHALL [response]` | æ¡ä»¶ä»˜ãè¦ä»¶ |

### 4.3 è¦ä»¶ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä½œæˆ

`storage/specs/REQ-MAS-requirements.md` ã« EARSå½¢å¼ã§è¦ä»¶ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

#### ä¾‹: äºˆç´„ä½œæˆè¦ä»¶

```markdown
### REQ-MAS-008: äºˆç´„ä½œæˆ
**ãƒ‘ã‚¿ãƒ¼ãƒ³**: Event-driven  
**å„ªå…ˆåº¦**: P0

WHEN a patient selects an available time slot, THE system SHALL create 
an appointment within 3 seconds, mark the slot as booked, and return 
a unique appointment ID.

**äº‹å‰æ¡ä»¶**: Time slot is available, patient has no conflicting appointment  
**äº‹å¾Œæ¡ä»¶**: Appointment status='confirmed', time slot status='booked'  
**ãƒˆãƒ¬ãƒ¼ã‚¹**: DES-MAS-003
```

### 4.4 è¦ä»¶æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰

```bash
npx musubix requirements validate storage/specs/REQ-MAS-requirements.md
```

### 4.5 æ¤œè¨¼çµæœ

```json
{
  "success": true,
  "valid": true,
  "issues": [],
  "summary": { "errors": 0, "warnings": 0, "info": 0 },
  "message": "âœ… All 20 requirements are valid"
}
```

### 4.6 MUSUBIXã®å‡¦ç†å†…å®¹

`musubix requirements validate` ã¯ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

1. **EARSæ§‹æ–‡è§£æ** - 5ãƒ‘ã‚¿ãƒ¼ãƒ³ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆWHEN, WHILE, SHALL, SHALL NOT, IF...THENï¼‰ã‚’æ¤œå‡º
2. **æ§‹æ–‡æ¤œè¨¼** - å„ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ–‡æ³•ãƒ«ãƒ¼ãƒ«ã«æº–æ‹ ã—ã¦ã„ã‚‹ã‹ç¢ºèª
3. **å„ªå…ˆåº¦ãƒã‚§ãƒƒã‚¯** - P0/P1/P2ã®å„ªå…ˆåº¦ãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
4. **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒªãƒ³ã‚¯æ¤œå‡º** - DES-*, TSK-* ã¸ã®å‚ç…§ã‚’æŠ½å‡º
5. **æ¸¬å®šå¯èƒ½æ€§åˆ†æ** - å…·ä½“çš„ãªæ•°å€¤ãƒ»æ™‚é–“åˆ¶ç´„ãŒã‚ã‚‹ã‹è©•ä¾¡

### 4.7 Medical Appointment System ã®è¦ä»¶ä¸€è¦§

| è¦ä»¶ID | åç§° | ãƒ‘ã‚¿ãƒ¼ãƒ³ | å„ªå…ˆåº¦ |
|--------|------|----------|--------|
| REQ-MAS-001 | æ‚£è€…æ–°è¦ç™»éŒ² | Event-driven | P0 |
| REQ-MAS-002 | æ‚£è€…ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«æ›´æ–° | Event-driven | P1 |
| REQ-MAS-003 | å€‹äººæƒ…å ±æš—å·åŒ– | Ubiquitous | P0 |
| REQ-MAS-004 | æ‚£è€…ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ | Ubiquitous | P0 |
| REQ-MAS-005 | åŒ»å¸«å°‚é–€åˆ†é‡ | Ubiquitous | P0 |
| REQ-MAS-006 | åŒ»å¸«æ™‚é–“æ è¨­å®š | Event-driven | P0 |
| REQ-MAS-007 | åŒ»å¸«æ¤œç´¢ | Event-driven | P1 |
| REQ-MAS-008 | äºˆç´„ä½œæˆ | Event-driven | P0 |
| REQ-MAS-009 | é‡è¤‡äºˆç´„é˜²æ­¢ | Unwanted | P0 |
| REQ-MAS-010 | äºˆç´„ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½æœŸé–“ | State-driven | P0 |
| REQ-MAS-011 | äºˆç´„ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯ | State-driven | P0 |
| REQ-MAS-012 | äºˆç´„å¤‰æ›´ | Event-driven | P1 |
| REQ-MAS-013 | äºˆç´„ç¢ºèªãƒ¡ãƒ¼ãƒ« | Event-driven | P1 |
| REQ-MAS-014 | äºˆç´„ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ | Ubiquitous | P0 |
| REQ-MAS-015 | JWTèªè¨¼ | Ubiquitous | P0 |
| REQ-MAS-016 | ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ– | Ubiquitous | P0 |
| REQ-MAS-017 | ç›£æŸ»ãƒ­ã‚° | Ubiquitous | P0 |
| REQ-MAS-018 | èªè¨¼å¤±æ•—ãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆ | State-driven | P1 |
| REQ-MAS-019 | APIå¿œç­”æ™‚é–“ | Ubiquitous | P1 |
| REQ-MAS-020 | åŒæ™‚ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•° | Ubiquitous | P1 |

### 4.8 ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ—ãƒ­ã‚»ã‚¹

MUSUBIXã§ã¯ã€å„ãƒ•ã‚§ãƒ¼ã‚ºçµ‚äº†æ™‚ã«ã‚»ãƒ«ãƒ•ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½ã—ã¾ã™ã€‚

#### ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

| è¦³ç‚¹ | ãƒã‚§ãƒƒã‚¯å†…å®¹ |
|------|--------------|
| EARSå½¢å¼æº–æ‹  | 5ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ§‹æ–‡ã«æº–æ‹ ã—ã¦ã„ã‚‹ã‹ |
| å„ªå…ˆåº¦è¨­å®š | P0/P1/P2ãŒé©åˆ‡ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ |
| æ¸¬å®šå¯èƒ½æ€§ | å…·ä½“çš„ãªæ•°å€¤ãƒ»æ™‚é–“åˆ¶ç´„ãŒã‚ã‚‹ã‹ |
| ç¶²ç¾…æ€§ | æ©Ÿèƒ½ãƒ»éæ©Ÿèƒ½ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶ãŒæƒã£ã¦ã„ã‚‹ã‹ |
| ä¸€è²«æ€§ | è¦ä»¶é–“ã§çŸ›ç›¾ãŒãªã„ã‹ |
| ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ | è¨­è¨ˆè¦ç´ ã¸ã®ãƒªãƒ³ã‚¯ãŒã‚ã‚‹ã‹ |

#### ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœã®è¡¨ç¤ºå½¢å¼

```
ğŸ“‹ **ãƒ¬ãƒ“ãƒ¥ãƒ¼çµæœ**

| è¦³ç‚¹ | çŠ¶æ…‹ | è©³ç´° |
|------|------|------|
| EARSå½¢å¼æº–æ‹  | âœ… OK | å…¨20ä»¶ãŒEARSæ§‹æ–‡ã«æº–æ‹  |
| å„ªå…ˆåº¦è¨­å®š | âœ… OK | P0: 13ä»¶, P1: 7ä»¶ |
| æ¸¬å®šå¯èƒ½æ€§ | âœ… OK | æ™‚é–“åˆ¶ç´„ãƒ»ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰æ˜ç¤º |
| ...  | ...  | ... |

ğŸ‘‰ **æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³:**
- ã€Œä¿®æ­£ã€â†’ æŒ‡æ‘˜ç®‡æ‰€ã‚’ä¿®æ­£ã—ã¦å†æç¤º
- ã€Œæ‰¿èªã€â†’ æ¬¡ãƒ•ã‚§ãƒ¼ã‚ºã¸é€²ã‚€
```

---

## 5. Phase 3: è¨­è¨ˆï¼ˆC4ãƒ¢ãƒ‡ãƒ«ï¼‰

### 5.1 C4ãƒ¢ãƒ‡ãƒ«ã¨ã¯

**C4ãƒ¢ãƒ‡ãƒ«**ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã‚’4ã¤ã®ãƒ¬ãƒ™ãƒ«ã§è¦–è¦šåŒ–ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚

| ãƒ¬ãƒ™ãƒ« | åç§° | èª¬æ˜ |
|--------|------|------|
| Level 1 | **System Context** | ã‚·ã‚¹ãƒ†ãƒ å¢ƒç•Œã¨å¤–éƒ¨ã‚¢ã‚¯ã‚¿ãƒ¼ |
| Level 2 | **Container** | æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã¨ã‚³ãƒ³ãƒ†ãƒŠæ§‹æˆ |
| Level 3 | **Component** | ã‚³ãƒ³ãƒ†ãƒŠå†…éƒ¨ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
| Level 4 | **Code** | å®Ÿè£…è©³ç´°ï¼ˆã‚¯ãƒ©ã‚¹å›³ç­‰ï¼‰ |

### 5.2 `musubix design generate` ã‚³ãƒãƒ³ãƒ‰

è¦ä»¶ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰C4ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆã‚’è‡ªå‹•ç”Ÿæˆã—ã¾ã™ã€‚

```bash
npx musubix design generate storage/specs/REQ-MAS-requirements.md
```

### 5.3 å®Ÿè¡Œçµæœ

```json
{
  "success": true,
  "design": {
    "level": "component",
    "title": "Component Diagram",
    "elements": 19,
    "relationships": 34
  },
  "patterns": [
    { "name": "Factory", "category": "creational" },
    { "name": "Singleton", "category": "creational" },
    { "name": "Observer", "category": "behavioral" }
  ],
  "traceability": [
    { "requirement": "REQ-MAS-001", "designElement": "PatientService" },
    { "requirement": "REQ-MAS-008", "designElement": "AppointmentService" },
    ...
  ],
  "message": "Generated component design with 19 elements"
}
```

### 5.4 MUSUBIXã®å‡¦ç†å†…å®¹

`musubix design generate` ã¯ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

1. **è¦ä»¶è§£æ** - EARSè¦ä»¶ã‹ã‚‰ãƒ‰ãƒ¡ã‚¤ãƒ³æ¦‚å¿µã‚’æŠ½å‡º
2. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆè­˜åˆ¥** - è²¬å‹™ã«åŸºã¥ã„ã¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’åˆ†é¡
3. **ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º** - é©ç”¨å¯èƒ½ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆGoFï¼‰ã‚’ææ¡ˆ
4. **é–¢ä¿‚æ€§ãƒãƒƒãƒ”ãƒ³ã‚°** - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©
5. **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒªãƒ³ã‚¯ç”Ÿæˆ** - REQ-* â†’ DES-* ã®å¯¾å¿œã‚’è‡ªå‹•ç”Ÿæˆ

### 5.5 ç”Ÿæˆã•ã‚Œã‚‹è¨­è¨ˆè¦ç´ 

#### Level 2: Container Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       Medical Appointment System                        â”‚
â”‚                                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   Web Client    â”‚   â”‚  Mobile Client  â”‚   â”‚   Admin Dashboard   â”‚   â”‚
â”‚  â”‚   (React SPA)   â”‚   â”‚  (React Native) â”‚   â”‚      (React)        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚                     â”‚                        â”‚              â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                 â”‚                                       â”‚
â”‚                                 â–¼                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                        API Gateway                               â”‚   â”‚
â”‚  â”‚                      (Node.js/Express)                           â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                 â”‚                                       â”‚
â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚       â–¼                         â–¼                         â–¼             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Auth Serviceâ”‚   â”‚ Appointment Service â”‚   â”‚ Notification Serviceâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚                     â”‚                         â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                               â”‚                                         â”‚
â”‚                               â–¼                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                       PostgreSQL Database                        â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### Level 3: Component Diagramï¼ˆä¸€éƒ¨ï¼‰

```
DES-MAS-APPT: Appointment Service
â”œâ”€â”€ DES-MAS-APPT-001: AppointmentController
â”‚   â””â”€â”€ ãƒˆãƒ¬ãƒ¼ã‚¹: REQ-MAS-008, REQ-MAS-010, REQ-MAS-011, REQ-MAS-012
â”œâ”€â”€ DES-MAS-APPT-002: AppointmentService
â”‚   â””â”€â”€ ãƒˆãƒ¬ãƒ¼ã‚¹: REQ-MAS-008, REQ-MAS-009, REQ-MAS-010, REQ-MAS-012
â”œâ”€â”€ DES-MAS-APPT-005: DuplicateBookingValidator
â”‚   â””â”€â”€ ãƒˆãƒ¬ãƒ¼ã‚¹: REQ-MAS-009
â””â”€â”€ DES-MAS-APPT-008: AppointmentFactory (Factory Pattern)
    â””â”€â”€ ãƒˆãƒ¬ãƒ¼ã‚¹: REQ-MAS-008
```

### 5.6 é©ç”¨è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³

MUSUBIXã¯ã€è¦ä»¶ã®ç‰¹æ€§ã«åŸºã¥ã„ã¦é©åˆ‡ãªè¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è‡ªå‹•ææ¡ˆã—ã¾ã™ã€‚

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | ã‚«ãƒ†ã‚´ãƒª | é©ç”¨ç®‡æ‰€ | ç›®çš„ |
|----------|----------|----------|------|
| **Factory** | ç”Ÿæˆ | AppointmentFactory | ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆã®ã‚«ãƒ—ã‚»ãƒ«åŒ– |
| **Singleton** | ç”Ÿæˆ | AuditLogger | ç›£æŸ»ãƒ­ã‚°ã®ä¸€å…ƒç®¡ç† |
| **Observer** | æŒ¯ã‚‹èˆã„ | NotificationObserver | ã‚¤ãƒ™ãƒ³ãƒˆé§†å‹•ã®é€šçŸ¥é…ä¿¡ |

### 5.7 è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æ§‹æˆ

```
storage/design/
â””â”€â”€ DES-MAS-design.md
    â”œâ”€â”€ 1. æ¦‚è¦
    â”œâ”€â”€ 2. C4ãƒ¢ãƒ‡ãƒ«
    â”‚   â”œâ”€â”€ Level 1: System Context
    â”‚   â”œâ”€â”€ Level 2: Container Diagram
    â”‚   â””â”€â”€ Level 3: Component Diagram
    â”œâ”€â”€ 3. é©ç”¨è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³
    â”œâ”€â”€ 4. ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«
    â”‚   â”œâ”€â”€ ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®šç¾©
    â”‚   â””â”€â”€ Value Objects
    â”œâ”€â”€ 5. ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹è¨­è¨ˆ
    â”‚   â”œâ”€â”€ REST API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ
    â”‚   â””â”€â”€ ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰è¨­è¨ˆ
    â”œâ”€â”€ 6. ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ
    â””â”€â”€ 7. ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒãƒˆãƒªã‚¯ã‚¹
```

### 5.8 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒãƒˆãƒªã‚¯ã‚¹ï¼ˆæŠœç²‹ï¼‰

| è¦ä»¶ | è¨­è¨ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | ãƒ‘ã‚¿ãƒ¼ãƒ³ |
|------|-------------------|----------|
| REQ-MAS-001 | DES-MAS-PATIENT-001, 002, 004 | - |
| REQ-MAS-008 | DES-MAS-APPT-001, 002, 003, 004, 008 | Factory |
| REQ-MAS-009 | DES-MAS-APPT-005 | - |
| REQ-MAS-013 | DES-MAS-NOTIFY-001, 002, 003, 004 | Observer |
| REQ-MAS-017 | DES-MAS-AUTH-006 | Singleton |

### 5.9 ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

| è¦³ç‚¹ | ãƒã‚§ãƒƒã‚¯å†…å®¹ |
|------|--------------|
| C4ãƒ¬ãƒ™ãƒ«ç¶²ç¾… | Context/Container/ComponentãŒæƒã£ã¦ã„ã‚‹ã‹ |
| SOLIDæº–æ‹  | å˜ä¸€è²¬ä»»ãƒ»é–‹æ”¾é–‰é–åŸå‰‡ã«å¾“ã£ã¦ã„ã‚‹ã‹ |
| ãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨ | è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã®é©ç”¨ç†ç”±ãŒæ˜ç¢ºã‹ |
| ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ | å…¨è¦ä»¶ãŒè¨­è¨ˆè¦ç´ ã«ãƒªãƒ³ã‚¯ã•ã‚Œã¦ã„ã‚‹ã‹ |
| ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹å®šç¾© | APIãƒ»ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ãŒæ˜ç¢ºã‹ |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­è¨ˆ | èªè¨¼ãƒ»æš—å·åŒ–ã®è¨­è¨ˆãŒé©åˆ‡ã‹ |

---

## 6. Phase 4: ã‚¿ã‚¹ã‚¯åˆ†è§£

### 6.1 ã‚¿ã‚¹ã‚¯åˆ†è§£ã¨ã¯

è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰å®Ÿè£…å¯èƒ½ãªå˜ä½ã®ã‚¿ã‚¹ã‚¯ã«åˆ†è§£ã™ã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã§ã™ã€‚

> **é‡è¦**: MUSUBIXã§ã¯ã€ã‚¿ã‚¹ã‚¯åˆ†è§£ã¯**è‡ªç„¶è¨€èªã«ã‚ˆã‚‹æŒ‡ç¤º**ã§å®Ÿè¡Œã—ã¾ã™ã€‚AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒè¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è§£æã—ã€é©åˆ‡ãªç²’åº¦ã®ã‚¿ã‚¹ã‚¯ã«åˆ†è§£ã—ã¾ã™ã€‚

### 6.2 è‡ªç„¶è¨€èªæŒ‡ç¤ºã«ã‚ˆã‚‹ã‚¿ã‚¹ã‚¯åˆ†è§£

MUSUBIXã®ã‚¿ã‚¹ã‚¯åˆ†è§£ã¯ã€å°‚ç”¨CLIã‚³ãƒãƒ³ãƒ‰ã§ã¯ãªãã€**AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¸ã®è‡ªç„¶è¨€èªæŒ‡ç¤º**ã§è¡Œã„ã¾ã™ã€‚

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: ã€Œè¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰ã‚¿ã‚¹ã‚¯ã‚’åˆ†è§£ã—ã¦ãã ã•ã„ã€

AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ:
1. è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆï¼ˆDES-MAS-design.mdï¼‰ã‚’è§£æ
2. ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’å®Ÿè£…å˜ä½ã«åˆ†è§£
3. ä¾å­˜é–¢ä¿‚ã‚’ç‰¹å®š
4. è¦‹ç©ã‚‚ã‚Šã‚’ç®—å‡º
5. TSK-MAS-tasks.md ã‚’ç”Ÿæˆ
```

**ã“ã®è¨­è¨ˆæ€æƒ³ã®ç†ç”±:**
- ã‚¿ã‚¹ã‚¯åˆ†è§£ã¯**ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆä¾å­˜**ãŒå¼·ã„ï¼ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç‰¹æ€§ã€ãƒãƒ¼ãƒ æ§‹æˆã€æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ï¼‰
- AIã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆãŒ**è¨­è¨ˆæ„å›³ã‚’ç†è§£**ã—ãŸä¸Šã§åˆ†è§£ã™ã‚‹ã“ã¨ã§ã€ã‚ˆã‚Šé©åˆ‡ãªç²’åº¦ã‚’å®Ÿç¾
- **å¯¾è©±çš„ãªèª¿æ•´**ãŒå¯èƒ½ï¼ˆã€Œã‚‚ã£ã¨ç´°ã‹ãåˆ†è§£ã—ã¦ã€ã€Œèªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã‚’å„ªå…ˆã—ã¦ã€ãªã©ï¼‰

### 6.3 ã‚¿ã‚¹ã‚¯åˆ†è§£ã®åŸå‰‡

| åŸå‰‡ | èª¬æ˜ |
|------|------|
| **ç²’åº¦** | 1ã‚¿ã‚¹ã‚¯ = 2ã€œ4æ™‚é–“ã®ä½œæ¥­é‡ |
| **ä¾å­˜é–¢ä¿‚** | æ˜ç¢ºãªå®Ÿè¡Œé †åºã‚’å®šç¾© |
| **ãƒ†ã‚¹ãƒˆå…ˆè¡Œ** | å„ã‚¿ã‚¹ã‚¯ã«ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯ã‚’å«ã‚€ |
| **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£** | DES-* â†’ TSK-* ã®ãƒªãƒ³ã‚¯ã‚’ç¶­æŒ |

### 6.3 ã‚¿ã‚¹ã‚¯IDå‘½åè¦å‰‡

```
TSK-{ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ}-{ã‚«ãƒ†ã‚´ãƒªç•ªå·}{é€£ç•ª}

ä¾‹:
TSK-MAS-001  â†’ å…±é€šåŸºç›¤ã‚¿ã‚¹ã‚¯#1
TSK-MAS-101  â†’ èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¹ã‚¯#1ï¼ˆ100ç³»ï¼‰
TSK-MAS-201  â†’ æ‚£è€…ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¹ã‚¯#1ï¼ˆ200ç³»ï¼‰
TSK-MAS-301  â†’ åŒ»å¸«ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¹ã‚¯#1ï¼ˆ300ç³»ï¼‰
TSK-MAS-401  â†’ äºˆç´„ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¹ã‚¯#1ï¼ˆ400ç³»ï¼‰
TSK-MAS-501  â†’ é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ã‚¿ã‚¹ã‚¯#1ï¼ˆ500ç³»ï¼‰
TSK-MAS-901  â†’ çµ±åˆã‚¿ã‚¹ã‚¯#1ï¼ˆ900ç³»ï¼‰
```

### 6.4 Medical Appointment System ã®ã‚¿ã‚¹ã‚¯æ§‹æˆ

| ã‚«ãƒ†ã‚´ãƒª | ã‚¿ã‚¹ã‚¯æ•° | åˆè¨ˆè¦‹ç©ã‚‚ã‚Š |
|----------|----------|--------------|
| å…±é€šåŸºç›¤ | 4 | 9h |
| èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹ | 7 | 17h |
| æ‚£è€…ã‚µãƒ¼ãƒ“ã‚¹ | 7 | 18h |
| åŒ»å¸«ã‚µãƒ¼ãƒ“ã‚¹ | 7 | 18h |
| äºˆç´„ã‚µãƒ¼ãƒ“ã‚¹ | 9 | 27h |
| é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ | 5 | 11h |
| çµ±åˆãƒ»æœ€çµ‚ | 6 | 17h |
| **åˆè¨ˆ** | **45ã‚¿ã‚¹ã‚¯** | **117h** |

### 6.5 å®Ÿè¡Œé †åºï¼ˆã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ãƒ‘ã‚¹ï¼‰

```
Phase A: åŸºç›¤æ§‹ç¯‰ï¼ˆWeek 1ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TSK-MAS-001 â†’ TSK-MAS-002 â†’ TSK-MAS-003
                    â†“
              TSK-MAS-004

Phase B: ã‚³ã‚¢ã‚µãƒ¼ãƒ“ã‚¹ä¸¦è¡Œé–‹ç™ºï¼ˆWeek 2-3ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[èªè¨¼]           [æ‚£è€…]           [åŒ»å¸«]
TSK-MAS-101      TSK-MAS-201      TSK-MAS-301
    â†“                â†“                â†“
   ...              ...              ...
    â†“                â†“                â†“
TSK-MAS-107      TSK-MAS-207      TSK-MAS-307

Phase C: äºˆç´„ãƒ»é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹ï¼ˆWeek 3-4ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[äºˆç´„]                    [é€šçŸ¥]
TSK-MAS-401 â†’ ... â†’ 409   TSK-MAS-501 â†’ ... â†’ 505

Phase D: çµ±åˆãƒ»æ¤œè¨¼ï¼ˆWeek 5ï¼‰
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
TSK-MAS-901 â†’ 902 â†’ 903 â†’ 904 â†’ 905 â†’ 906
```

### 6.6 ã‚¿ã‚¹ã‚¯è©³ç´°ã®æ§‹æˆè¦ç´ 

å„ã‚¿ã‚¹ã‚¯ã¯ä»¥ä¸‹ã®è¦ç´ ã‚’å«ã¿ã¾ã™ï¼š

```markdown
### TSK-MAS-XXX: ã‚¿ã‚¹ã‚¯å

**è¦‹ç©ã‚‚ã‚Š**: Xh  
**ä¾å­˜**: TSK-MAS-YYY  
**ãƒˆãƒ¬ãƒ¼ã‚¹**: DES-MAS-ZZZ, REQ-MAS-WWW

**å®Œäº†æ¡ä»¶**:
- [ ] å®Ÿè£…é …ç›®1
- [ ] å®Ÿè£…é …ç›®2
- [ ] ãƒ†ã‚¹ãƒˆä½œæˆ

**å—ã‘å…¥ã‚ŒåŸºæº–**:
\`\`\`typescript
// ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ä¾‹
expect(result.isOk()).toBe(true);
\`\`\`
```

### 6.7 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒãƒˆãƒªã‚¯ã‚¹ï¼ˆæŠœç²‹ï¼‰

| è¦ä»¶ | è¨­è¨ˆ | ã‚¿ã‚¹ã‚¯ |
|------|------|--------|
| REQ-MAS-001 | DES-MAS-PATIENT-001,002,004 | TSK-MAS-201,205,206 |
| REQ-MAS-008 | DES-MAS-APPT-001,002,003,004,008 | TSK-MAS-401,402,405,407,408 |
| REQ-MAS-009 | DES-MAS-APPT-005 | TSK-MAS-403,904 |
| REQ-MAS-015 | DES-MAS-AUTH-001,002,003 | TSK-MAS-102,105,106 |

### 6.8 MUSUBIXã®å‡¦ç†å†…å®¹

ã‚¿ã‚¹ã‚¯åˆ†è§£ã§ã¯ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

1. **ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†æ** - è¨­è¨ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰å®Ÿè£…å˜ä½ã‚’ç‰¹å®š
2. **ä¾å­˜é–¢ä¿‚è§£æ** - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“ã®ä¾å­˜é–¢ä¿‚ã‚’ã‚¿ã‚¹ã‚¯é †åºã«å¤‰æ›
3. **è¦‹ç©ã‚‚ã‚Šç®—å‡º** - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®è¤‡é›‘åº¦ã«åŸºã¥ã„ã¦å·¥æ•°ã‚’è¦‹ç©ã‚‚ã‚Š
4. **ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯ç”Ÿæˆ** - å„ã‚µãƒ¼ãƒ“ã‚¹ã«ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯ã‚’è‡ªå‹•è¿½åŠ 
5. **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒªãƒ³ã‚¯** - DES-* â†’ TSK-* ã®å¯¾å¿œã‚’ç”Ÿæˆ

### 6.9 ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

| è¦³ç‚¹ | ãƒã‚§ãƒƒã‚¯å†…å®¹ |
|------|--------------|
| ã‚¿ã‚¹ã‚¯ç²’åº¦ | 1ã‚¿ã‚¹ã‚¯2ã€œ4æ™‚é–“ã®ç¯„å›²å†…ã‹ |
| ä¾å­˜é–¢ä¿‚ | å¾ªç’°ä¾å­˜ãŒãªã„ã‹ã€é †åºãŒå¦¥å½“ã‹ |
| ç¶²ç¾…æ€§ | å…¨è¨­è¨ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒã‚¿ã‚¹ã‚¯åŒ–ã•ã‚Œã¦ã„ã‚‹ã‹ |
| ãƒ†ã‚¹ãƒˆå…ˆè¡Œ | å„ã‚µãƒ¼ãƒ“ã‚¹ã«ãƒ†ã‚¹ãƒˆã‚¿ã‚¹ã‚¯ãŒã‚ã‚‹ã‹ |
| ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ | REQâ†’DESâ†’TSKã®ãƒªãƒ³ã‚¯ãŒå®Œå…¨ã‹ |
| è¦‹ç©ã‚‚ã‚Šå¦¥å½“æ€§ | åˆè¨ˆå·¥æ•°ãŒç¾å®Ÿçš„ã‹ |

---

## 7. Phase 5: ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ

### 7.1 ã‚³ãƒ¼ãƒ‰ç”Ÿæˆã¨ã¯

è¨­è¨ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‹ã‚‰TypeScriptã®ã‚¹ã‚±ãƒ«ãƒˆãƒ³ã‚³ãƒ¼ãƒ‰ã‚’è‡ªå‹•ç”Ÿæˆã™ã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã§ã™ã€‚

### 7.2 `musubix codegen generate` ã‚³ãƒãƒ³ãƒ‰

```bash
npx musubix codegen generate storage/design/DES-MAS-design.md --output src/
```

### 7.3 å®Ÿè¡Œçµæœ

```
âœ… Code generated in /tmp/medical-appointment-system/src
```

### 7.4 MUSUBIXã®å‡¦ç†å†…å®¹

`musubix codegen generate` ã¯ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

1. **è¨­è¨ˆè§£æ** - C4ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå›³ã‹ã‚‰ã‚¯ãƒ©ã‚¹/ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ã‚’æŠ½å‡º
2. **ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º** - Factory, Singleton, Observerç­‰ã®è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è­˜åˆ¥
3. **ã‚¹ã‚±ãƒ«ãƒˆãƒ³ç”Ÿæˆ** - TypeScriptã‚³ãƒ¼ãƒ‰ã®åŸºæœ¬æ§‹é€ ã‚’ç”Ÿæˆ
4. **ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£æ³¨å…¥** - `@ãƒˆãƒ¬ãƒ¼ã‚¹` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ¡ãƒ³ãƒˆã«è¿½åŠ 
5. **ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹é©ç”¨** - BP-CODE-*, BP-DESIGN-* ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’è‡ªå‹•é©ç”¨

### 7.5 ç”Ÿæˆã•ã‚Œã‚‹ã‚³ãƒ¼ãƒ‰æ§‹é€ 

```
src/
â”œâ”€â”€ common/               # å…±é€šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ result.ts         # Result<T, E> å‹å®šç¾©
â”‚   â”œâ”€â”€ errors.ts         # ã‚¨ãƒ©ãƒ¼å‹ãƒ»ã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰
â”‚   â””â”€â”€ id-generator.ts   # IDç”Ÿæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
â”œâ”€â”€ auth/                 # èªè¨¼ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â””â”€â”€ audit-logger.ts   # ç›£æŸ»ãƒ­ã‚°ï¼ˆSingletonï¼‰
â”œâ”€â”€ patient/              # æ‚£è€…ã‚µãƒ¼ãƒ“ã‚¹
â”œâ”€â”€ doctor/               # åŒ»å¸«ã‚µãƒ¼ãƒ“ã‚¹
â”œâ”€â”€ appointment/          # äºˆç´„ã‚µãƒ¼ãƒ“ã‚¹
â”‚   â”œâ”€â”€ appointment.entity.ts           # ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£å®šç¾©
â”‚   â”œâ”€â”€ appointment.factory.ts          # Factory Pattern
â”‚   â”œâ”€â”€ duplicate-booking.validator.ts  # é‡è¤‡äºˆç´„æ¤œè¨¼
â”‚   â””â”€â”€ cancellation-policy.enforcer.ts # ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒãƒªã‚·ãƒ¼
â””â”€â”€ notification/         # é€šçŸ¥ã‚µãƒ¼ãƒ“ã‚¹
    â””â”€â”€ notification.observer.ts        # Observer Pattern
```

### 7.6 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šResultå‹ï¼ˆBP-CODE-005ï¼‰

```typescript
/**
 * Resultå‹ - å¤±æ•—å¯èƒ½ãªæ“ä½œã®æˆ»ã‚Šå€¤
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ BP-CODE-005
 */

export type Result<T, E> = Ok<T> | Err<E>;

export interface Ok<T> {
  readonly _tag: 'Ok';
  readonly value: T;
}

export interface Err<E> {
  readonly _tag: 'Err';
  readonly error: E;
}

export function ok<T>(value: T): Ok<T> {
  return { _tag: 'Ok', value };
}

export function err<E>(error: E): Err<E> {
  return { _tag: 'Err', error };
}
```

### 7.7 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šIDç”Ÿæˆï¼ˆBP-CODE-002ï¼‰

```typescript
/**
 * IDç”Ÿæˆãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ BP-CODE-002
 * å½¢å¼: PREFIX-YYYYMMDD-NNN
 */

export function createPatientId(): Result<PatientId, ValidationError> {
  return ok({ value: generateId('PAT') });
  // ä¾‹: PAT-20260108-001
}

export function createAppointmentId(): Result<AppointmentId, ValidationError> {
  return ok({ value: generateId('APT') });
  // ä¾‹: APT-20260108-001
}
```

### 7.8 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ãƒãƒƒãƒ—ï¼ˆBP-DESIGN-001ï¼‰

```typescript
/**
 * ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹é·ç§»ãƒãƒƒãƒ—
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ BP-DESIGN-001, REQ-MAS-010, REQ-MAS-011
 */
export const validStatusTransitions: Record<AppointmentStatus, AppointmentStatus[]> = {
  pending: ['confirmed', 'cancelled'],
  confirmed: ['completed', 'cancelled', 'no_show'],
  cancelled: [], // çµ‚ç«¯çŠ¶æ…‹
  completed: [], // çµ‚ç«¯çŠ¶æ…‹
  no_show: [],   // çµ‚ç«¯çŠ¶æ…‹
};
```

### 7.9 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šFactory Pattern

```typescript
/**
 * Appointment Factory (Factory Pattern)
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ DES-MAS-APPT-008, DES-PAT-001, REQ-MAS-008
 */
export function createAppointmentFactory(): AppointmentFactory {
  return {
    create(input: CreateAppointmentInput): Result<Appointment, ValidationError> {
      // ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
      if (!input.patientId?.value) {
        return err(new ValidationError('Patient ID is required', 'patientId'));
      }
      // ... 
      return ok(appointment);
    },
  };
}
```

### 7.10 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šObserver Pattern

```typescript
/**
 * Notification Observer (Observer Pattern)
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ DES-MAS-NOTIFY-004, DES-PAT-003, REQ-MAS-013
 */
export interface AppointmentEventObserver {
  onAppointmentCreated(appointment: Appointment): Promise<void>;
  onAppointmentCancelled(appointment: Appointment): Promise<void>;
  onAppointmentRescheduled(old: Appointment, new: Appointment): Promise<void>;
}
```

### 7.11 ã‚³ãƒ¼ãƒ‰ä¾‹ï¼šå½¢å¼ä»•æ§˜ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

```typescript
/**
 * Duplicate Booking Validator
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ DES-MAS-APPT-005, REQ-MAS-009
 * 
 * å½¢å¼ä»•æ§˜:
 * âˆ€ slot âˆˆ TimeSlots: slot.status = 'booked' â†’ Â¬âˆƒ new_appointment(slot)
 */
export function createDuplicateBookingValidator(
  timeSlotRepo: TimeSlotRepository,
): DuplicateBookingValidator {
  return {
    async validate(timeSlotId, patientId): Promise<Result<void, AppError>> {
      const timeSlot = await timeSlotRepo.findById(timeSlotId);
      
      // å½¢å¼ä»•æ§˜ã®å®Ÿè£…: slot.status = 'booked' â†’ reject
      if (timeSlot.status === 'booked') {
        return err(SLOT_ALREADY_BOOKED);
      }
      return ok(undefined);
    },
  };
}
```

### 7.12 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³

ç”Ÿæˆã•ã‚ŒãŸã™ã¹ã¦ã®ã‚³ãƒ¼ãƒ‰ã«ã¯ã€`@ãƒˆãƒ¬ãƒ¼ã‚¹` ã‚¢ãƒãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ãŒä»˜ä¸ã•ã‚Œã¾ã™ï¼š

| ãƒ•ã‚¡ã‚¤ãƒ« | ãƒˆãƒ¬ãƒ¼ã‚¹å…ˆ |
|----------|------------|
| `result.ts` | BP-CODE-005 |
| `errors.ts` | REQ-MAS-009, REQ-MAS-011, REQ-MAS-018 |
| `id-generator.ts` | BP-CODE-002 |
| `appointment.entity.ts` | DES-MAS-APPT-004, REQ-MAS-008 |
| `appointment.factory.ts` | DES-MAS-APPT-008, DES-PAT-001, REQ-MAS-008 |
| `duplicate-booking.validator.ts` | DES-MAS-APPT-005, REQ-MAS-009 |
| `cancellation-policy.enforcer.ts` | DES-MAS-APPT-006, REQ-MAS-010, REQ-MAS-011 |
| `audit-logger.ts` | DES-MAS-AUTH-006, DES-PAT-002, REQ-MAS-017 |
| `notification.observer.ts` | DES-MAS-NOTIFY-004, DES-PAT-003, REQ-MAS-013 |

---

## 8. Phase 6: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ

### 8.1 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æã¨ã¯

ç”Ÿæˆã—ãŸã‚³ãƒ¼ãƒ‰ã«å¯¾ã—ã¦ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„†å¼±æ€§ã‚’ã‚¹ã‚­ãƒ£ãƒ³ã™ã‚‹ãƒ•ã‚§ãƒ¼ã‚ºã§ã™ã€‚MUSUBIXã¯**OWASP Top 10**ãŠã‚ˆã³**CWE Top 25**ã«å¯¾å¿œã—ãŸæ¤œå‡ºãƒ«ãƒ¼ãƒ«ã‚’æä¾›ã—ã¾ã™ã€‚

### 8.2 `musubix codegen security` ã‚³ãƒãƒ³ãƒ‰

```bash
npx musubix codegen security src/
```

### 8.3 å®Ÿè¡Œçµæœ

```json
{
  "success": true,
  "vulnerabilities": [],
  "summary": { "critical": 0, "high": 0, "medium": 0, "low": 0 },
  "score": 100,
  "message": "âœ… Security score: 100/100 - No critical issues"
}
```

### 8.4 MUSUBIXã®å‡¦ç†å†…å®¹

`musubix codegen security` ã¯ä»¥ä¸‹ã®å‡¦ç†ã‚’å®Ÿè¡Œã—ã¾ã™ï¼š

1. **ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒãƒ³ã‚°** - æ—¢çŸ¥ã®è„†å¼±æ€§ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º
2. **ãƒ†ã‚¤ãƒ³ãƒˆè§£æ** - ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®ãƒˆãƒ¬ãƒ¼ã‚¹
3. **ã‚·ãƒ¼ã‚¯ãƒ¬ãƒƒãƒˆæ¤œå‡º** - ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸèªè¨¼æƒ…å ±ã®æ¤œå‡º
4. **ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯** - æ—¢çŸ¥ã®è„†å¼±æ€§ã‚’æŒã¤ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ¤œå‡º

### 8.5 æ¤œå‡ºå¯¾è±¡ã®è„†å¼±æ€§ã‚«ãƒ†ã‚´ãƒª

#### OWASP Top 10 (2021)

| ãƒ©ãƒ³ã‚¯ | ã‚«ãƒ†ã‚´ãƒª | MUSUBIXã®å¯¾å¿œ |
|--------|----------|---------------|
| A01 | Broken Access Control | ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¤œè¨¼ |
| A02 | Cryptographic Failures | å¼±ã„æš—å·åŒ–ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ¤œå‡º |
| A03 | Injection | SQL/NoSQL/ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®æ¤œå‡º |
| A04 | Insecure Design | è¨­è¨ˆãƒ¬ãƒ™ãƒ«ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ¬ãƒ“ãƒ¥ãƒ¼ |
| A05 | Security Misconfiguration | è¨­å®šãƒŸã‚¹ã®æ¤œå‡º |
| A06 | Vulnerable Components | è„†å¼±ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®æ¤œå‡º |
| A07 | Auth Failures | èªè¨¼ãƒ»ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®å•é¡Œæ¤œå‡º |
| A08 | Software Integrity | æ•´åˆæ€§æ¤œè¨¼ã®æ¬ å¦‚ã‚’æ¤œå‡º |
| A09 | Logging Failures | ãƒ­ã‚°ãƒ»ç›£è¦–ã®å•é¡Œæ¤œå‡º |
| A10 | SSRF | ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ã‚¸ã‚§ãƒªæ¤œå‡º |

#### CWE Top 25 (æŠœç²‹)

| CWE ID | åç§° | æ¤œå‡ºæ–¹æ³• |
|--------|------|----------|
| CWE-79 | XSS | HTMLã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã®æ¬ å¦‚ |
| CWE-89 | SQLi | ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®ä¸ä½¿ç”¨ |
| CWE-287 | èªè¨¼ãƒã‚¤ãƒ‘ã‚¹ | èªè¨¼ãƒã‚§ãƒƒã‚¯ã®æ¬ å¦‚ |
| CWE-798 | ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚ŒãŸèªè¨¼æƒ…å ± | æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒƒãƒ |
| CWE-502 | å®‰å…¨ã§ãªã„ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¼ãƒ¼ã‚·ãƒ§ãƒ³ | eval/Functionä½¿ç”¨ |

### 8.6 é™çš„ã‚³ãƒ¼ãƒ‰è§£æ

ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ã«åŠ ãˆã¦ã€é™çš„ã‚³ãƒ¼ãƒ‰è§£æã‚‚å®Ÿè¡Œã§ãã¾ã™ã€‚

```bash
npx musubix codegen analyze src/
```

#### è§£æçµæœ

```json
{
  "success": true,
  "issues": [
    {
      "file": "src/auth/audit-logger.ts",
      "line": 38,
      "severity": "info",
      "rule": "no-console",
      "message": "Console statements should be removed in production code."
    }
    // ... ä»–ã® info ãƒ¬ãƒ™ãƒ«ã®è­¦å‘Š
  ],
  "metrics": {
    "files": 11,
    "lines": 742,
    "complexity": 74,
    "maintainabilityIndex": 100
  },
  "summary": { "errors": 0, "warnings": 0, "info": 24 },
  "message": "âœ… Analyzed 11 files - No errors found"
}
```

### 8.7 Medical Appointment System ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–

#### èªè¨¼ãƒ»èªå¯ï¼ˆREQ-MAS-015, REQ-MAS-016, REQ-MAS-018ï¼‰

```typescript
/**
 * Password Hasher
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ DES-MAS-AUTH-004, REQ-MAS-016
 * 
 * ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶:
 * - bcryptã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ä½¿ç”¨
 * - cost factor = 12
 */
export function createPasswordHasher(): PasswordHasher {
  const COST_FACTOR = 12;  // OWASPæ¨å¥¨å€¤
  // ...
}
```

#### ãƒ‡ãƒ¼ã‚¿æš—å·åŒ–ï¼ˆREQ-MAS-003ï¼‰

```typescript
/**
 * Personal Info Encryptor
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ DES-MAS-PATIENT-005, REQ-MAS-003
 * 
 * ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¦ä»¶:
 * - AES-256-GCMæš—å·åŒ–ï¼ˆèªè¨¼ä»˜ãæš—å·ï¼‰
 * - æš—å·åŒ–ã‚­ãƒ¼ã¯ç’°å¢ƒå¤‰æ•°ã‹ã‚‰å–å¾—ï¼ˆCWE-798å¯¾ç­–ï¼‰
 */
const ALGORITHM = 'aes-256-gcm';  // NISTæ¨å¥¨
```

#### ç›£æŸ»ãƒ­ã‚°ï¼ˆREQ-MAS-017ï¼‰

```typescript
/**
 * Audit Logger
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ DES-MAS-AUTH-006, REQ-MAS-017
 * 
 * è¨˜éŒ²å¯¾è±¡:
 * - ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œï¼ˆæˆåŠŸ/å¤±æ•—ï¼‰
 * - ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹
 * - æ¨©é™å¤‰æ›´
 */
export interface AuditEntry {
  readonly timestamp: Date;
  readonly userId: string;
  readonly action: string;
  readonly resource: string;
  readonly ip?: string;
}
```

### 8.8 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢ã®è§£é‡ˆ

| ã‚¹ã‚³ã‚¢ | è©•ä¾¡ | èª¬æ˜ |
|--------|------|------|
| 90-100 | å„ªç§€ | é‡å¤§ãªè„†å¼±æ€§ãªã— |
| 70-89 | è‰¯å¥½ | è»½å¾®ãªå•é¡Œã®ã¿ |
| 50-69 | æ³¨æ„ | ä¸­ç¨‹åº¦ã®è„†å¼±æ€§ã‚ã‚Š |
| 0-49 | å±é™º | é‡å¤§ãªè„†å¼±æ€§ã‚ã‚Š |

### 8.9 ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

| è¦³ç‚¹ | ãƒã‚§ãƒƒã‚¯å†…å®¹ |
|------|--------------|
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢ | 90ç‚¹ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ |
| Critical/High | 0ä»¶ã§ã‚ã‚‹ã“ã¨ |
| æš—å·åŒ– | AES-256-GCM/bcryptä½¿ç”¨ |
| èªè¨¼æƒ…å ± | ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ã•ã‚Œã¦ã„ãªã„ã“ã¨ |
| ç›£æŸ»ãƒ­ã‚° | å¿…è¦ãªã‚¤ãƒ™ãƒ³ãƒˆãŒè¨˜éŒ²ã•ã‚Œã‚‹ã“ã¨ |
| ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ | é©åˆ‡ãªèªå¯ãƒã‚§ãƒƒã‚¯ãŒã‚ã‚‹ã“ã¨ |

---

## 9. Phase 7: å½¢å¼æ¤œè¨¼

### 9.1 å½¢å¼æ¤œè¨¼ã¨ã¯

**å½¢å¼æ¤œè¨¼**ã¯ã€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã®æ­£ã—ã•ã‚’æ•°å­¦çš„ã«è¨¼æ˜ã™ã‚‹æ‰‹æ³•ã§ã™ã€‚MUSUBIXã¯**Z3 SMTã‚½ãƒ«ãƒ**ã‚’ä½¿ç”¨ã—ã¦ã€EARSè¦ä»¶ã®è«–ç†çš„æ•´åˆæ€§ã‚’æ¤œè¨¼ã—ã¾ã™ã€‚

### 9.2 MUSUBIXã®å½¢å¼æ¤œè¨¼æ©Ÿèƒ½

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| **EARSâ†’SMTå¤‰æ›** | EARSè¦ä»¶ã‚’SMT-LIB2å½¢å¼ã«è‡ªå‹•å¤‰æ› |
| **äº‹å‰æ¡ä»¶æ¤œè¨¼** | é–¢æ•°ã®å…¥åŠ›æ¡ä»¶ã®å……è¶³å¯èƒ½æ€§ã‚’æ¤œè¨¼ |
| **äº‹å¾Œæ¡ä»¶æ¤œè¨¼** | Hoareãƒˆãƒªãƒ—ãƒ« {P} C {Q} ã®æ¤œè¨¼ |
| **å®‰å…¨æ€§æ¤œè¨¼** | ã‚·ã‚¹ãƒ†ãƒ ãŒå®‰å…¨ã§ãªã„çŠ¶æ…‹ã«åˆ°é”ã—ãªã„ã“ã¨ã‚’è¨¼æ˜ |

### 9.3 SMTï¼ˆSatisfiability Modulo Theoriesï¼‰ã¨ã¯

SMTã¯ã€å‘½é¡Œè«–ç†ã«åŠ ãˆã¦**æ•´æ•°ãƒ»å®Ÿæ•°ãƒ»é…åˆ—ãƒ»ãƒ“ãƒƒãƒˆãƒ™ã‚¯ãƒˆãƒ«**ãªã©ã®ç†è«–ã‚’æ‰±ãˆã‚‹å……è¶³å¯èƒ½æ€§åˆ¤å®šå•é¡Œã§ã™ã€‚

```
ä¾‹: ã€Œx > 0 ã‹ã¤ y > 0 ã‹ã¤ x + y = 10ã€ã‚’æº€ãŸã™ x, y ã¯å­˜åœ¨ã™ã‚‹ã‹ï¼Ÿ
â†’ sat (å……è¶³å¯èƒ½): x=5, y=5 ãªã©
```

### 9.4 EARSè¦ä»¶ã‹ã‚‰SMT-LIB2ã¸ã®å¤‰æ›

#### ä¾‹: REQ-MAS-009ï¼ˆé‡è¤‡äºˆç´„é˜²æ­¢ï¼‰

**EARSè¦ä»¶:**
```
THE system SHALL NOT allow booking an already booked time slot.
```

**å½¢å¼ä»•æ§˜:**
```
âˆ€ slot âˆˆ TimeSlots: slot.status = 'booked' â†’ Â¬âˆƒ new_appointment(slot)
```

**SMT-LIB2å¤‰æ›çµæœ:**
```smt2
; MUSUBIX Formal Verification
; Requirement: REQ-MAS-009 - é‡è¤‡äºˆç´„é˜²æ­¢
; @ãƒˆãƒ¬ãƒ¼ã‚¹ REQ-MAS-009, DES-MAS-APPT-005

(set-logic ALL)

; TimeSlotçŠ¶æ…‹: 0=available, 1=booked, 2=blocked
(declare-const slot_status Int)
(declare-const booking_attempted Bool)
(declare-const booking_success Bool)

; slot_statusã¯0, 1, 2ã®ã„ãšã‚Œã‹
(assert (and (>= slot_status 0) (<= slot_status 2)))

; å®‰å…¨æ€§: äºˆç´„æ¸ˆã¿ã‚¹ãƒ­ãƒƒãƒˆã¸ã®äºˆç´„ã¯å¤±æ•—ã™ã¹ã
; slot.status = 'booked' âˆ§ booking_attempted â†’ Â¬booking_success
(assert (=> (and (= slot_status 1) booking_attempted)
            (not booking_success)))

(check-sat)
```

### 9.5 ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒãƒªã‚·ãƒ¼ã®å½¢å¼æ¤œè¨¼

#### REQ-MAS-010, REQ-MAS-011

**EARSè¦ä»¶:**
- REQ-MAS-010: 24æ™‚é–“ä»¥ä¸Šå‰ â†’ ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½
- REQ-MAS-011: 24æ™‚é–“ä»¥å†… â†’ ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯

**SMT-LIB2:**
```smt2
(set-logic QF_LRA)

; äºˆç´„æ™‚åˆ»ã¾ã§ã®æ®‹ã‚Šæ™‚é–“ï¼ˆæ™‚é–“å˜ä½ï¼‰
(declare-const hours_until_appointment Real)
(declare-const cancel_attempted Bool)
(declare-const cancel_success Bool)

(define-const CANCELLATION_WINDOW Real 24.0)

; REQ-MAS-010: 24æ™‚é–“ä»¥ä¸Šå‰ãªã‚‰ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯èƒ½
(assert (=> (and cancel_attempted 
                 (>= hours_until_appointment CANCELLATION_WINDOW))
            cancel_success))

; REQ-MAS-011: 24æ™‚é–“ä»¥å†…ã¯ã‚­ãƒ£ãƒ³ã‚»ãƒ«ä¸å¯
(assert (=> (and cancel_attempted 
                 (< hours_until_appointment CANCELLATION_WINDOW))
            (not cancel_success)))

(check-sat)
```

### 9.6 æ¤œè¨¼çµæœã®è§£é‡ˆ

| çµæœ | æ„å‘³ |
|------|------|
| **sat** | å……è¶³å¯èƒ½ - æ¡ä»¶ã‚’æº€ãŸã™å€¤ãŒå­˜åœ¨ |
| **unsat** | å……è¶³ä¸å¯èƒ½ - æ¡ä»¶ã‚’æº€ãŸã™å€¤ã¯å­˜åœ¨ã—ãªã„ |
| **unknown** | åˆ¤å®šä¸èƒ½ - ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã¾ãŸã¯è¤‡é›‘ã™ãã‚‹ |

#### å®‰å…¨æ€§æ¤œè¨¼ã®å ´åˆ

```
ä»•æ§˜: ã€Œå±é™ºãªçŠ¶æ…‹ã«åˆ°é”ã§ãã‚‹ã€
çµæœ: unsat â†’ å®‰å…¨æ€§ãŒä¿è¨¼ã•ã‚Œã‚‹ï¼ˆå±é™ºãªçŠ¶æ…‹ã«åˆ°é”ä¸å¯èƒ½ï¼‰
çµæœ: sat   â†’ åä¾‹ã‚ã‚Šï¼ˆå±é™ºãªçŠ¶æ…‹ã«åˆ°é”å¯èƒ½ï¼‰
```

### 9.7 Hoareãƒˆãƒªãƒ—ãƒ«æ¤œè¨¼

**Hoareãƒˆãƒªãƒ—ãƒ«**: `{P} C {Q}`
- **P**: äº‹å‰æ¡ä»¶ï¼ˆPreconditionï¼‰
- **C**: ã‚³ãƒãƒ³ãƒ‰ï¼ˆCommandï¼‰
- **Q**: äº‹å¾Œæ¡ä»¶ï¼ˆPostconditionï¼‰

```typescript
// ä¾‹: æ®‹é«˜ã‹ã‚‰ã®å¼•ãå‡ºã—
// {P} balance >= amount && amount > 0
// {C} balance_new := balance - amount
// {Q} balance_new == balance - amount && balance_new >= 0
```

### 9.8 å½¢å¼æ¤œè¨¼ãƒ•ã‚¡ã‚¤ãƒ«ã®æ§‹æˆ

```
storage/formal-verify/
â”œâ”€â”€ FV-MAS-009-duplicate-booking.smt2   # é‡è¤‡äºˆç´„é˜²æ­¢
â”œâ”€â”€ FV-MAS-010-011-cancellation.smt2    # ã‚­ãƒ£ãƒ³ã‚»ãƒ«ãƒãƒªã‚·ãƒ¼
â””â”€â”€ verification-report.json             # æ¤œè¨¼çµæœãƒ¬ãƒãƒ¼ãƒˆ
```

### 9.9 æ¤œè¨¼ãƒ¬ãƒãƒ¼ãƒˆä¾‹

```json
{
  "requirement": "REQ-MAS-009",
  "description": "é‡è¤‡äºˆç´„é˜²æ­¢",
  "formalSpec": "âˆ€ slot âˆˆ TimeSlots: slot.status = 'booked' â†’ Â¬âˆƒ new_appointment(slot)",
  "verification": {
    "status": "verified",
    "result": "unsat",
    "interpretation": "å®‰å…¨æ€§ãŒæ•°å­¦çš„ã«è¨¼æ˜ã•ã‚ŒãŸ",
    "duration": 45
  },
  "traceability": {
    "design": "DES-MAS-APPT-005",
    "code": "src/appointment/duplicate-booking.validator.ts"
  }
}
```

### 9.10 ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹

| è¦³ç‚¹ | ãƒã‚§ãƒƒã‚¯å†…å®¹ |
|------|--------------|
| å¤‰æ›ç²¾åº¦ | EARSè¦ä»¶ãŒæ­£ç¢ºã«SMT-LIB2ã«å¤‰æ›ã•ã‚Œã¦ã„ã‚‹ã‹ |
| æ¤œè¨¼çµæœ | å®‰å…¨æ€§è¦ä»¶ãŒ unsatï¼ˆè¨¼æ˜æ¸ˆã¿ï¼‰ã‹ |
| ã‚«ãƒãƒ¬ãƒƒã‚¸ | é‡è¦ãªè¦ä»¶ãŒå½¢å¼æ¤œè¨¼ã•ã‚Œã¦ã„ã‚‹ã‹ |
| åä¾‹åˆ†æ | sat ã®å ´åˆã€åä¾‹ãŒå¦¥å½“ã‹ |

---

## 10. Phase 8: ãƒ†ã‚¹ãƒˆç”Ÿæˆ

### 10.1 ãƒ†ã‚¹ãƒˆç”Ÿæˆã‚³ãƒãƒ³ãƒ‰

```bash
# ç‰¹å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ†ã‚¹ãƒˆç”Ÿæˆ
npx musubix test generate src/appointment/appointment.entity.ts

# å‡ºåŠ›
âœ… Tests generated: src/appointment/__tests__/appointment.entity.test.ts (0 test cases)
   - Framework: vitest
   - Style: unit
```

### 10.2 ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/
â”œâ”€â”€ appointment/
â”‚   â”œâ”€â”€ appointment.entity.ts
â”‚   â””â”€â”€ __tests__/
â”‚       â”œâ”€â”€ appointment.entity.test.ts    # 158è¡Œ, 10ãƒ†ã‚¹ãƒˆ
â”‚       â””â”€â”€ appointment.factory.test.ts   # Factory Pattern
â”œâ”€â”€ auth/
â”‚   â””â”€â”€ __tests__/
â”‚       â””â”€â”€ audit-logger.test.ts          # 110è¡Œ, 9ãƒ†ã‚¹ãƒˆï¼ˆSingletonï¼‰
â””â”€â”€ notification/
    â””â”€â”€ __tests__/
        â””â”€â”€ notification.observer.test.ts # 138è¡Œ, 9ãƒ†ã‚¹ãƒˆï¼ˆObserverï¼‰
```

**åˆè¨ˆ**: 4ãƒ•ã‚¡ã‚¤ãƒ«, 406è¡Œ, 28ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹

### 10.3 ãƒ†ã‚¹ãƒˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

#### BP-TEST-001: Test Counter Reset

```typescript
import { beforeEach } from 'vitest';
import { resetAppointmentCounter } from '../appointment.entity';

beforeEach(() => {
  resetAppointmentCounter(); // IDã‚«ã‚¦ãƒ³ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ
});
```

#### BP-TEST-004: Result Type Test Pattern

```typescript
import { isOk, isErr } from '../../common/result';

describe('createAppointment', () => {
  // æˆåŠŸã‚±ãƒ¼ã‚¹
  it('should create a valid appointment', () => {
    const result = createAppointment({ ... });
    expect(isOk(result)).toBe(true);
    if (isOk(result)) {
      expect(result.value.status).toBe('scheduled');
    }
  });

  // å¤±æ•—ã‚±ãƒ¼ã‚¹
  it('should reject invalid duration', () => {
    const result = createAppointment({ durationMinutes: 0, ... });
    expect(isErr(result)).toBe(true);
  });
});
```

#### BP-TEST-005: Status Transition Testing

```typescript
describe('Status Transitions', () => {
  it('should only allow valid status transitions', () => {
    const validTransitions: Record<AppointmentStatus, AppointmentStatus[]> = {
      scheduled: ['confirmed', 'cancelled'],
      confirmed: ['completed', 'no_show', 'cancelled'],
      completed: [],
      cancelled: [],
      no_show: [],
    };

    // æœ‰åŠ¹ãªé·ç§»
    expect(validTransitions['scheduled']).toContain('confirmed');
    // ç„¡åŠ¹ãªé·ç§»
    expect(validTransitions['scheduled']).not.toContain('completed');
  });
});
```

### 10.4 Singleton Patternã®ãƒ†ã‚¹ãƒˆ

```typescript
describe('AuditLogger (Singleton)', () => {
  // åŒä¸€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ç¢ºèª
  it('should return the same instance', () => {
    const instance1 = AuditLogger.getInstance();
    const instance2 = AuditLogger.getInstance();
    expect(instance1).toBe(instance2);
  });

  // çŠ¶æ…‹ã®å…±æœ‰ç¢ºèª
  it('should maintain state across getInstance calls', () => {
    logger.log({ action: 'CREATE', ... });
    const sameLogger = AuditLogger.getInstance();
    expect(sameLogger.getLogs()).toHaveLength(1);
  });
});
```

### 10.5 Observer Patternã®ãƒ†ã‚¹ãƒˆ

```typescript
describe('Notification Observer Pattern', () => {
  it('should notify all observers', () => {
    const emailSpy = vi.spyOn(emailObserver, 'update');
    const smsSpy = vi.spyOn(smsObserver, 'update');

    subject.attach(emailObserver);
    subject.attach(smsObserver);

    const event: NotificationEvent = {
      type: 'APPOINTMENT_CONFIRMED',
      appointmentId: 'APPT-001',
      patientId: 'PAT-001',
      message: 'Your appointment has been confirmed',
      timestamp: new Date(),
    };

    subject.notify(event);

    expect(emailSpy).toHaveBeenCalledWith(event);
    expect(smsSpy).toHaveBeenCalledWith(event);
  });
});
```

### 10.6 è¦ä»¶ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£

å„ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚³ãƒ¡ãƒ³ãƒˆã‚’å«ã‚ã¾ã™ï¼š

```typescript
/**
 * Appointment Entity ãƒ†ã‚¹ãƒˆ
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ REQ-MAS-001, REQ-MAS-009, REQ-MAS-010, REQ-MAS-011
 */
```

| ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | ãƒˆãƒ¬ãƒ¼ã‚¹å…ˆè¦ä»¶ |
|---------------|----------------|
| appointment.entity.test.ts | REQ-MAS-001, 009, 010, 011 |
| audit-logger.test.ts | REQ-MAS-019 |
| notification.observer.test.ts | REQ-MAS-006, 007 |

### 10.7 ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
npx vitest run

# ã‚¦ã‚©ãƒƒãƒãƒ¢ãƒ¼ãƒ‰
npx vitest

# ã‚«ãƒãƒ¬ãƒƒã‚¸è¨ˆæ¸¬
npx vitest run --coverage
```

---

## 11. Phase 9: ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£

### 11.1 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã¨ã¯

**ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£**ã¯ã€è¦ä»¶â†’è¨­è¨ˆâ†’å®Ÿè£…â†’ãƒ†ã‚¹ãƒˆã®å…¨ã¦ã®æˆæœç‰©é–“ã®å¯¾å¿œé–¢ä¿‚ã‚’è¿½è·¡å¯èƒ½ã«ã™ã‚‹ã“ã¨ã§ã™ã€‚MUSUBIXã¯æ†²æ³•æ¡é …Vï¼ˆTraceabilityï¼‰ã«åŸºã¥ãã€100%ã®è¿½è·¡å¯èƒ½æ€§ã‚’è¦æ±‚ã—ã¾ã™ã€‚

### 11.2 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚³ãƒãƒ³ãƒ‰

```bash
# ãƒãƒˆãƒªã‚¯ã‚¹ç”Ÿæˆ
npx musubix trace matrix

# å‡ºåŠ›ä¾‹
{
  success: true,
  entries: [...],
  statistics: {
    requirements: 20,
    designs: 5,
    tasks: 0,
    implementations: 0,
    tests: 0,
    coverage: 0
  },
  message: 'Generated traceability matrix with 25 entries (0.0% coverage)'
}
```

### 11.3 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£æ¤œè¨¼

```bash
# ãƒªãƒ³ã‚¯æ¤œè¨¼
npx musubix trace validate

# å‡ºåŠ›ä¾‹
{
  success: true,
  valid: true,
  issues: [
    {
      type: 'orphan',
      severity: 'warning',
      source: 'REQ-MAS-001',
      message: 'Requirement REQ-MAS-001 has no implementation'
    },
    ...
  ],
  summary: { total: 100, valid: 100, broken: 0, orphans: 20 },
  message: 'âš ï¸ Found 20 issues (0 broken links, 20 orphans)'
}
```

### 11.4 å½±éŸ¿åˆ†æï¼ˆImpact Analysisï¼‰

```bash
# ç‰¹å®šè¦ä»¶ã®å½±éŸ¿ç¯„å›²ã‚’åˆ†æ
npx musubix trace impact REQ-MAS-009

# å‡ºåŠ›ä¾‹
{
  success: true,
  sourceId: 'REQ-MAS-009',
  impacts: [
    {
      id: 'DES-MAS-001',
      type: 'design',
      impactLevel: 'direct',
      description: 'Design element'
    },
    ...
  ],
  riskLevel: 'medium',
  message: 'Found 5 impacted items (Risk: medium)'
}
```

### 11.5 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒãƒˆãƒªã‚¯ã‚¹

#### è¦ä»¶ â†’ è¨­è¨ˆ ãƒãƒƒãƒ”ãƒ³ã‚°

| è¦ä»¶ID | è¦ä»¶å | è¨­è¨ˆID | è¨­è¨ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ |
|--------|--------|--------|-------------------|
| REQ-MAS-001 | äºˆç´„ä½œæˆ | DES-MAS-APPT-001 | AppointmentService |
| REQ-MAS-006 | äºˆç´„ç¢ºèªé€šçŸ¥ | DES-MAS-NOTIFY-001 | NotificationService |
| REQ-MAS-009 | é‡è¤‡äºˆç´„é˜²æ­¢ | DES-MAS-APPT-005 | DuplicateBookingValidator |
| REQ-MAS-010 | 24hå‰ã‚­ãƒ£ãƒ³ã‚»ãƒ«å¯ | DES-MAS-APPT-006 | CancellationPolicyEnforcer |
| REQ-MAS-015 | æ‚£è€…æƒ…å ±æš—å·åŒ– | DES-MAS-PAT-001 | PersonalInfoEncryptor |
| REQ-MAS-019 | ç›£æŸ»ãƒ­ã‚° | DES-MAS-AUTH-006 | AuditLogger |

#### è¨­è¨ˆ â†’ å®Ÿè£… ãƒãƒƒãƒ”ãƒ³ã‚°

| è¨­è¨ˆID | ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ | å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« |
|--------|---------------|--------------|
| DES-MAS-APPT-001 | AppointmentEntity | appointment.entity.ts |
| DES-MAS-APPT-008 | AppointmentFactory | appointment.factory.ts |
| DES-MAS-AUTH-006 | AuditLogger | audit-logger.ts |
| DES-MAS-PAT-001 | PersonalInfoEncryptor | personal-info-encryptor.ts |
| DES-MAS-NOTIFY-004 | NotificationObserver | notification.observer.ts |

#### å®Ÿè£… â†’ ãƒ†ã‚¹ãƒˆ ãƒãƒƒãƒ”ãƒ³ã‚°

| å®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ« | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ« | ãƒ†ã‚¹ãƒˆæ•° |
|-------------|---------------|----------|
| appointment.entity.ts | appointment.entity.test.ts | 10 |
| audit-logger.ts | audit-logger.test.ts | 9 |
| notification.observer.ts | notification.observer.test.ts | 9 |

### 11.6 ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚µãƒãƒªãƒ¼

| ã‚«ãƒ†ã‚´ãƒª | ç·æ•° | è¨­è¨ˆæ¸ˆã¿ | å®Ÿè£…æ¸ˆã¿ | ãƒ†ã‚¹ãƒˆæ¸ˆã¿ | ã‚«ãƒãƒ¬ãƒƒã‚¸ |
|---------|------|---------|---------|-----------|-----------|
| äºˆç´„ç®¡ç† | 5 | 5 | 3 | 1 | 60% |
| é€šçŸ¥ | 3 | 3 | 1 | 1 | 33% |
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ | 8 | 8 | 3 | 1 | 37% |
| ãƒ¬ãƒãƒ¼ãƒˆ | 1 | 1 | 0 | 0 | 0% |
| **åˆè¨ˆ** | **20** | **20** | **11** | **4** | **55%** |

### 11.7 ã‚³ãƒ¼ãƒ‰å†…ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å†…ã« `@ãƒˆãƒ¬ãƒ¼ã‚¹` ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¿½åŠ ã—ã¦è¿½è·¡æ€§ã‚’ç¢ºä¿ï¼š

```typescript
/**
 * äºˆç´„ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£
 * @ãƒˆãƒ¬ãƒ¼ã‚¹ REQ-MAS-001, REQ-MAS-009
 * @è¨­è¨ˆ DES-MAS-APPT-001
 */
export interface Appointment {
  // ...
}
```

### 11.8 ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«

```
storage/traceability/
â””â”€â”€ trace-matrix.md   # å®Œå…¨ãªãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒãƒˆãƒªã‚¯ã‚¹
```

---

## 12. é«˜åº¦ãªæ©Ÿèƒ½ï¼ˆv2.2.0ï¼‰

### 12.1 è‡ªå·±å­¦ç¿’ã‚·ã‚¹ãƒ†ãƒ 

MUSUBIXã¯é–‹ç™ºãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å­¦ç¿’ã—ã€ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå›ºæœ‰ã®æ¨å¥¨ã‚’æä¾›ã—ã¾ã™ã€‚

#### ãƒ‘ã‚¿ãƒ¼ãƒ³ç™»éŒ²

```bash
# ãƒ‡ã‚¶ã‚¤ãƒ³ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç™»éŒ²
npx musubix learn add-pattern "Factory Pattern" \
  --category code \
  --confidence 0.95 \
  --action prefer \
  --content "Use Factory pattern for entity creation with validation" \
  --language typescript

# å‡ºåŠ›
âœ“ Pattern created: PAT-306D4DBC
  Name: Factory Pattern
  Category: code
  Action: prefer
  Confidence: 95.0%
```

#### ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¨˜éŒ²

```bash
# è¦ä»¶ã¸ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
npx musubix learn feedback REQ-MAS-001 \
  --type accept \
  --artifact-type requirement \
  --reason "Well-defined EARS requirement"

# å‡ºåŠ›
âœ“ Feedback recorded: FB-84B8AD1F
  Type: accept
  Artifact: requirement/REQ-MAS-001
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è¦§è¡¨ç¤º

```bash
npx musubix learn patterns

# å‡ºåŠ›
Learned Patterns:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  PAT-306D4DBC - Factory Pattern
    Category: code, Action: prefer
    Confidence: 95.0%, Occurrences: 1

  PAT-93076A30 - Result Type Error Handling
    Category: code, Action: prefer
    Confidence: 95.0%, Occurrences: 1

  PAT-6942ADA5 - Singleton Pattern
    Category: design, Action: prefer
    Confidence: 90.0%, Occurrences: 1

  PAT-5910460B - Observer Pattern
    Category: design, Action: prefer
    Confidence: 90.0%, Occurrences: 1

Total: 4 patterns
```

#### å­¦ç¿’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹

```bash
npx musubix learn status

# å‡ºåŠ›
# MUSUBIX Learning Status Report

## Summary
- Total Feedback: 1
- Total Patterns: 4
- Average Confidence: 92.5%

## Feedback by Type
- Accept: 1
- Reject: 0
- Modify: 0

## High Confidence Patterns (â‰¥70%)
- Factory Pattern (95.0%)
- Result Type Error Handling (95.0%)
- Singleton Pattern (90.0%)
- Observer Pattern (90.0%)
```

#### å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ/ã‚¤ãƒ³ãƒãƒ¼ãƒˆ

```bash
# ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
npx musubix learn export --output storage/learning/patterns-export.json

# ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
npx musubix learn import storage/learning/patterns-export.json
```

**ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå½¢å¼:**
```json
{
  "feedback": [
    {
      "id": "FB-84B8AD1F",
      "timestamp": "2026-01-08T14:28:56.411Z",
      "type": "accept",
      "artifactType": "requirement",
      "artifactId": "REQ-MAS-001",
      "reason": "Well-defined EARS requirement"
    }
  ],
  "patterns": [
    {
      "id": "PAT-306D4DBC",
      "name": "Factory Pattern",
      "category": "code",
      "action": { "type": "prefer", "content": "..." },
      "confidence": 0.95,
      "occurrences": 1
    }
  ]
}
```

### 12.2 Neural Searchï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ APIï¼‰

v2.2.0ã§ã¯ã€ã‚³ãƒ¼ãƒ‰æ¤œç´¢ã®ãŸã‚ã®Neural Search APIãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚

```typescript
import {
  ContextAwareEmbedder,
  HybridRanker,
  EmbeddingCache,
  createTrajectoryLogger,
} from '@nahisaho/musubix-neural-search';

// æ¤œç´¢è»Œè·¡ã®ãƒ­ã‚®ãƒ³ã‚°
const logger = createTrajectoryLogger();
logger.logBranch({ depth: 1, score: 0.85, action: 'expand' });
logger.logBranch({ depth: 2, score: 0.92, action: 'select' });

// Parquetå½¢å¼ã§ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
const parquet = logger.export('parquet');

// ãƒã‚¤ãƒ–ãƒªãƒƒãƒ‰ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆBM25 + ãƒ™ã‚¯ãƒˆãƒ«é¡ä¼¼åº¦ï¼‰
const ranker = new HybridRanker();
const results = ranker.rank(query, candidates, {
  bm25Weight: 0.3,
  vectorWeight: 0.7,
});
```

### 12.3 Library Learnerï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ APIï¼‰

APIãƒ‘ã‚¿ãƒ¼ãƒ³ã®å­¦ç¿’ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†ã‚’æä¾›ã—ã¾ã™ã€‚

```typescript
import {
  SemanticChunker,
  PatternVersionManager,
  createMetricsExporter,
} from '@nahisaho/musubix-library-learner';

// ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒãƒ¼ã‚¸ãƒ§ãƒ³ç®¡ç†
const versionManager = new PatternVersionManager();
versionManager.commit(pattern, 'Added validation logic');
const history = versionManager.getHistory(patternId);

// ãƒ¡ãƒˆãƒªã‚¯ã‚¹ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
const exporter = createMetricsExporter(library);
const markdown = exporter.export('markdown');
const summary = exporter.getSummary();
// { healthStatus: 'good', patternCount: 42, avgConfidence: 0.87 }
```

### 12.4 Program Synthesisï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ APIï¼‰

ä¾‹é¡Œã‹ã‚‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’åˆæˆã—ã¾ã™ã€‚

```typescript
import {
  createMetaLearningEngine,
  createExampleAnalyzer,
  createExplanationGenerator,
} from '@nahisaho/musubix-synthesis';

// ä¾‹é¡Œå“è³ªåˆ†æ
const analyzer = createExampleAnalyzer();
const quality = analyzer.analyze([
  { input: 'hello', output: 'HELLO' },
  { input: 'world', output: 'WORLD' },
]);
// { coverage: 0.8, diversity: 0.6, complexity: 'low' }

// ãƒ—ãƒ­ã‚°ãƒ©ãƒ åˆæˆ
const engine = createMetaLearningEngine();
const program = await engine.synthesize(examples);

// èª¬æ˜ç”Ÿæˆ
const explainer = createExplanationGenerator();
const explanation = explainer.generate(program);
const summary = explainer.summarize(program);
// "Converts input string to uppercase"
```

### 12.5 å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«

```
storage/learning/
â””â”€â”€ patterns-export.json   # å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
    - feedback: ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯å±¥æ­´
    - patterns: å­¦ç¿’æ¸ˆã¿ãƒ‘ã‚¿ãƒ¼ãƒ³
```

---

## 13. ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚µãƒãƒªãƒ¼

### 13.1 Medical Appointment System å®ŒæˆçŠ¶æ³

æœ¬ã‚¬ã‚¤ãƒ‰ã§æ§‹ç¯‰ã—ãŸ **Medical Appointment System** ã®æœ€çµ‚æˆæœç‰©ã§ã™ã€‚

#### ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆçµ±è¨ˆ

| é …ç›® | æ•°å€¤ |
|------|------|
| **EARSè¦ä»¶** | 20ä»¶ï¼ˆ5ã‚«ãƒ†ã‚´ãƒªï¼‰ |
| **è¨­è¨ˆã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ** | 19ä»¶ï¼ˆC4ãƒ¢ãƒ‡ãƒ«ï¼‰ |
| **å®Ÿè£…ã‚¿ã‚¹ã‚¯** | 45ä»¶ï¼ˆ117æ™‚é–“ï¼‰ |
| **TypeScriptãƒ•ã‚¡ã‚¤ãƒ«** | 11ä»¶ï¼ˆ742è¡Œï¼‰ |
| **ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«** | 4ä»¶ï¼ˆ406è¡Œã€28ãƒ†ã‚¹ãƒˆï¼‰ |
| **è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³** | 3ç¨®ï¼ˆFactory, Singleton, Observerï¼‰ |
| **å­¦ç¿’ãƒ‘ã‚¿ãƒ¼ãƒ³** | 4ä»¶ï¼ˆ92.5%å¹³å‡ä¿¡é ¼åº¦ï¼‰ |

#### ãƒ•ã‚§ãƒ¼ã‚ºåˆ¥æˆæœç‰©

| Phase | æˆæœç‰© | ãƒ•ã‚¡ã‚¤ãƒ« |
|-------|--------|---------|
| 1 | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– | `musubix.config.json` |
| 2 | EARSè¦ä»¶å®šç¾© | `storage/specs/REQ-MAS-requirements.md` |
| 3 | C4ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ | `storage/design/DES-MAS-design.md` |
| 4 | ã‚¿ã‚¹ã‚¯åˆ†è§£ | `storage/tasks/TSK-MAS-tasks.md` |
| 5 | ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ | `src/**/*.ts`ï¼ˆ11ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰ |
| 6 | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ | ã‚¹ã‚³ã‚¢ 100/100 |
| 7 | å½¢å¼æ¤œè¨¼ | `storage/formal-verify/*.smt2` |
| 8 | ãƒ†ã‚¹ãƒˆç”Ÿæˆ | `src/**/__tests__/*.test.ts` |
| 9 | ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ | `storage/traceability/trace-matrix.md` |
| 10 | å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ | `storage/learning/patterns-export.json` |

#### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
/tmp/medical-appointment-system/
â”œâ”€â”€ musubix.config.json
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ common/
â”‚   â”‚   â”œâ”€â”€ result.ts
â”‚   â”‚   â”œâ”€â”€ errors.ts
â”‚   â”‚   â””â”€â”€ id-generator.ts
â”‚   â”œâ”€â”€ appointment/
â”‚   â”‚   â”œâ”€â”€ appointment.entity.ts
â”‚   â”‚   â”œâ”€â”€ appointment.factory.ts
â”‚   â”‚   â”œâ”€â”€ duplicate-booking.validator.ts
â”‚   â”‚   â”œâ”€â”€ cancellation-policy.enforcer.ts
â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚       â”œâ”€â”€ appointment.entity.test.ts
â”‚   â”‚       â””â”€â”€ appointment.factory.test.ts
â”‚   â”œâ”€â”€ auth/
â”‚   â”‚   â”œâ”€â”€ audit-logger.ts
â”‚   â”‚   â”œâ”€â”€ password-hasher.ts
â”‚   â”‚   â””â”€â”€ __tests__/
â”‚   â”‚       â””â”€â”€ audit-logger.test.ts
â”‚   â”œâ”€â”€ patient/
â”‚   â”‚   â””â”€â”€ personal-info-encryptor.ts
â”‚   â””â”€â”€ notification/
â”‚       â”œâ”€â”€ notification.observer.ts
â”‚       â””â”€â”€ __tests__/
â”‚           â””â”€â”€ notification.observer.test.ts
â””â”€â”€ storage/
    â”œâ”€â”€ specs/
    â”‚   â””â”€â”€ REQ-MAS-requirements.md
    â”œâ”€â”€ design/
    â”‚   â””â”€â”€ DES-MAS-design.md
    â”œâ”€â”€ tasks/
    â”‚   â””â”€â”€ TSK-MAS-tasks.md
    â”œâ”€â”€ formal-verify/
    â”‚   â”œâ”€â”€ FV-MAS-009-duplicate-booking.smt2
    â”‚   â””â”€â”€ FV-MAS-010-011-cancellation.smt2
    â”œâ”€â”€ traceability/
    â”‚   â””â”€â”€ trace-matrix.md
    â””â”€â”€ learning/
        â””â”€â”€ patterns-export.json
```

### 13.2 ä½¿ç”¨ã—ãŸMUSUBIXã‚³ãƒãƒ³ãƒ‰

```bash
# Phase 1: åˆæœŸåŒ–
npx musubix init /tmp/medical-appointment-system

# Phase 2: è¦ä»¶æ¤œè¨¼
npx musubix requirements validate storage/specs/REQ-MAS-requirements.md

# Phase 5: ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ
npx musubix codegen generate storage/design/DES-MAS-design.md

# Phase 6: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£åˆ†æ
npx musubix codegen security src/
npx musubix codegen analyze src/

# Phase 8: ãƒ†ã‚¹ãƒˆç”Ÿæˆ
npx musubix test generate src/appointment/appointment.entity.ts

# Phase 9: ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£
npx musubix trace matrix
npx musubix trace validate
npx musubix trace impact REQ-MAS-009

# Phase 10: è‡ªå·±å­¦ç¿’
npx musubix learn add-pattern "Factory Pattern" --category code --action prefer
npx musubix learn feedback REQ-MAS-001 --type accept --artifact-type requirement
npx musubix learn patterns
npx musubix learn status
npx musubix learn export --output storage/learning/patterns-export.json
```

### 13.3 å“è³ªãƒ¡ãƒˆãƒªã‚¯ã‚¹

| ãƒ¡ãƒˆãƒªã‚¯ã‚¹ | å€¤ | åŸºæº– |
|-----------|-----|------|
| ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚³ã‚¢ | 100/100 | â‰¥80 |
| è„†å¼±æ€§æ¤œå‡º | 0ä»¶ | 0 |
| EARSæº–æ‹ ç‡ | 100% | 100% |
| ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ã‚«ãƒãƒ¬ãƒƒã‚¸ | 55% | â‰¥80%ï¼ˆç›®æ¨™ï¼‰ |
| ãƒ‘ã‚¿ãƒ¼ãƒ³ä¿¡é ¼åº¦ | 92.5% | â‰¥70% |

---

## 14. ãã®ä»–ã®æ©Ÿèƒ½

æœ¬ã‚¬ã‚¤ãƒ‰ã§ä½¿ç”¨ã—ãªã‹ã£ãŸMUSUBIXã®æ©Ÿèƒ½ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

### 14.1 è¦ä»¶åˆ†æã®è‡ªå‹•åŒ–

#### è‡ªç„¶è¨€èªã‹ã‚‰EARSå¤‰æ›

```bash
# è‡ªç„¶è¨€èªã®è¦ä»¶ã‚’EARSå½¢å¼ã«è‡ªå‹•å¤‰æ›
npx musubix requirements analyze "ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯ãƒ­ã‚°ã‚¤ãƒ³ã§ãã‚‹å¿…è¦ãŒã‚ã‚‹"

# å‡ºåŠ›ä¾‹
THE system SHALL allow users to login with valid credentials.
Pattern: Ubiquitous
```

#### ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼ãƒãƒƒãƒ”ãƒ³ã‚°

```bash
# è¦ä»¶ã‚’çŸ¥è­˜ã‚°ãƒ©ãƒ•ã«ãƒãƒƒãƒ”ãƒ³ã‚°
npx musubix requirements map storage/specs/REQ-*.md

# é–¢é€£è¦ä»¶ã®æ¤œç´¢
npx musubix requirements search "authentication"
```

#### å¯¾è©±çš„è¦ä»¶ä½œæˆ

```bash
# å¯¾è©±å½¢å¼ã§è¦ä»¶ã‚’ä½œæˆ
npx musubix requirements new "user-authentication"
```

### 14.2 è¨­è¨ˆè‡ªå‹•ç”Ÿæˆ

#### è¦ä»¶ã‹ã‚‰è¨­è¨ˆã‚’ç”Ÿæˆ

```bash
# è¦ä»¶ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è¨­è¨ˆã‚’è‡ªå‹•ç”Ÿæˆ
npx musubix design generate storage/specs/REQ-MAS-requirements.md

# C4ãƒ€ã‚¤ã‚¢ã‚°ãƒ©ãƒ ç”Ÿæˆ
npx musubix design c4 storage/design/DES-MAS-design.md

# SOLIDæº–æ‹ æ¤œè¨¼
npx musubix design validate storage/design/DES-MAS-design.md
```

#### ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º

```bash
# ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«é©ã—ãŸãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ¤œå‡º
npx musubix design patterns "notification system with multiple channels"

# å‡ºåŠ›ä¾‹
Recommended patterns:
- Observer Pattern (confidence: 95%)
- Strategy Pattern (confidence: 78%)
```

#### ADRç”Ÿæˆ

```bash
# Architecture Decision Record ã‚’ç”Ÿæˆ
npx musubix design adr "Use Observer pattern for notifications"
```

### 14.3 èª¬æ˜ãƒ»å¯è¦–åŒ–

#### æ±ºå®šç†ç”±ã®èª¬æ˜

```bash
# ãªãœãã®æ±ºå®šãŒã•ã‚ŒãŸã‹ã‚’èª¬æ˜
npx musubix explain why DES-MAS-NOTIFY-004

# å‡ºåŠ›ä¾‹
Decision: Use Observer Pattern
Reason: Multiple notification channels (Email, SMS, Push) require
        loose coupling and independent notification delivery.
Trace: REQ-MAS-006 â†’ REQ-MAS-007 â†’ REQ-MAS-008
```

#### æ¨è«–ã‚°ãƒ©ãƒ•ç”Ÿæˆ

```bash
# æ¨è«–ã®éç¨‹ã‚’ã‚°ãƒ©ãƒ•ã¨ã—ã¦å¯è¦–åŒ–
npx musubix explain graph REQ-MAS-009 --output reasoning.svg
```

### 14.4 ã‚ªãƒ³ãƒˆãƒ­ã‚¸ãƒ¼æ“ä½œ

#### çŸ¥è­˜ã‚°ãƒ©ãƒ•æ¤œè¨¼

```bash
# çŸ¥è­˜ã‚°ãƒ©ãƒ•ã®æ•´åˆæ€§æ¤œè¨¼
npx musubix ontology validate -f storage/knowledge/kg.ttl

# å¾ªç’°ä¾å­˜ãƒã‚§ãƒƒã‚¯
npx musubix ontology check-circular -f storage/knowledge/kg.ttl

# çµ±è¨ˆè¡¨ç¤º
npx musubix ontology stats -f storage/knowledge/kg.ttl
```

### 14.5 KGPRï¼ˆKnowledge Graph Pull Requestï¼‰

çŸ¥è­˜ã‚’ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨å…±æœ‰ã™ã‚‹ãŸã‚ã®æ©Ÿèƒ½ã§ã™ã€‚

```bash
# KGPRã®ä½œæˆ
npx musubix kgpr create -t "Medical Appointment Patterns"

# å·®åˆ†ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
npx musubix kgpr diff

# KGPRä¸€è¦§
npx musubix kgpr list

# é€ä¿¡
npx musubix kgpr submit <id>

# è©³ç´°è¡¨ç¤º
npx musubix kgpr show <id>

# ã‚¯ãƒ­ãƒ¼ã‚º
npx musubix kgpr close <id>
```

### 14.6 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰

#### DDDãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç”Ÿæˆ

```bash
# ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ç”Ÿæˆ
npx musubix scaffold domain-model medical-system \
  -e "Patient,Appointment,Doctor" \
  -d MEDICAL

# æœ€å°æ§‹æˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ
npx musubix scaffold minimal my-project

# APIã‚µãƒ¼ãƒ“ã‚¹
npx musubix scaffold api-service user-service
```

### 14.7 ãƒ—ãƒ­ã‚°ãƒ©ãƒ åˆæˆ

ä¾‹é¡Œã‹ã‚‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’è‡ªå‹•åˆæˆã—ã¾ã™ã€‚

```bash
# ä¾‹é¡Œãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰ãƒ—ãƒ­ã‚°ãƒ©ãƒ åˆæˆ
npx musubix synthesize examples.json

# examples.json ã®å½¢å¼
[
  { "input": "hello", "output": "HELLO" },
  { "input": "world", "output": "WORLD" }
]

# å‡ºåŠ›: function transform(input) { return input.toUpperCase(); }
```

### 14.8 å¯¾è©±çš„REPL

```bash
# å¯¾è©±çš„ã‚·ã‚§ãƒ«ã‚’èµ·å‹•
npx musubix repl

# REPLã‚³ãƒãƒ³ãƒ‰ä¾‹
musubix> requirements validate REQ-001
musubix> trace impact REQ-001
musubix> learn status
musubix> .exit
```

### 14.9 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯

```bash
# ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬
npx musubix perf benchmark

# å‡ºåŠ›ä¾‹
Benchmark Results:
- Requirements validation: 45ms
- Design generation: 230ms
- Code analysis: 180ms
```

### 14.10 è¿½åŠ ã®å­¦ç¿’ã‚³ãƒãƒ³ãƒ‰

```bash
# ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆãƒ™ãƒ¼ã‚¹ã®æ¨å¥¨
npx musubix learn recommend --artifact-type code --language typescript

# æœªä½¿ç”¨ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æ¸›è¡°
npx musubix learn decay --threshold 30 --factor 0.9

# å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
npx musubix learn import shared-patterns.json --merge-strategy merge

# ãƒ‘ã‚¿ãƒ¼ãƒ³å‰Šé™¤
npx musubix learn remove-pattern PAT-XXXXXX
```

### 14.11 ã‚¿ã‚¹ã‚¯ç®¡ç†

```bash
# ã‚¿ã‚¹ã‚¯ä¸€è¦§
npx musubix tasks list

# ã‚¿ã‚¹ã‚¯æ¤œè¨¼
npx musubix tasks validate storage/tasks/TSK-*.md
```

### 14.12 ãƒ‘ã‚¿ãƒ¼ãƒ³ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

```bash
# ãƒ©ã‚¤ãƒ–ãƒ©ãƒªçµ±è¨ˆ
npx musubix library stats

# ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œç´¢
npx musubix library query "error handling"

# ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ãƒ‘ã‚¿ãƒ¼ãƒ³å­¦ç¿’
npx musubix library learn src/
```

### 14.13 GitHub Agent Skills

```bash
# ã‚¹ã‚­ãƒ«ä¸€è¦§
npx musubix skills list

# ã‚¹ã‚­ãƒ«è¿½åŠ 
npx musubix skills add pattern-recognition
```

---

## ä»˜éŒ²

### ä»˜éŒ²A: 9æ¡æ†²æ³•

| æ¡é … | åç§° | æ¦‚è¦ |
|-----|------|------|
| I | Library-First | æ©Ÿèƒ½ã¯ç‹¬ç«‹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã—ã¦é–‹å§‹ |
| II | CLI Interface | ã™ã¹ã¦ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯CLIå…¬é–‹å¿…é ˆ |
| III | Test-First | Red-Green-Blueã‚µã‚¤ã‚¯ãƒ«ã§ãƒ†ã‚¹ãƒˆå…ˆè¡Œ |
| IV | EARS Format | è¦ä»¶ã¯EARSå½¢å¼ã§è¨˜è¿° |
| V | Traceability | è¦ä»¶â†”è¨­è¨ˆâ†”ã‚³ãƒ¼ãƒ‰â†”ãƒ†ã‚¹ãƒˆã®100%è¿½è·¡ |
| VI | Project Memory | steering/ã‚’å‚ç…§ã—ã¦ã‹ã‚‰æ±ºå®š |
| VII | Design Patterns | è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³é©ç”¨ã®æ–‡æ›¸åŒ– |
| VIII | Decision Records | ã™ã¹ã¦ã®æ±ºå®šã‚’ADRã§è¨˜éŒ² |
| IX | Quality Gates | ãƒ•ã‚§ãƒ¼ã‚ºç§»è¡Œå‰ã®å“è³ªæ¤œè¨¼ |


### ä»˜éŒ²B: CLIã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

| ã‚³ãƒãƒ³ãƒ‰ | èª¬æ˜ |
|---------|------|
| `musubix init` | ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆåˆæœŸåŒ– |
| `musubix requirements analyze` | è¦ä»¶åˆ†æï¼ˆè‡ªç„¶è¨€èªâ†’EARSï¼‰ |
| `musubix requirements validate` | è¦ä»¶æ¤œè¨¼ |
| `musubix design generate` | è¨­è¨ˆç”Ÿæˆ |
| `musubix design patterns` | ãƒ‘ã‚¿ãƒ¼ãƒ³æ¤œå‡º |
| `musubix codegen generate` | ã‚³ãƒ¼ãƒ‰ç”Ÿæˆ |
| `musubix codegen analyze` | é™çš„è§£æ |
| `musubix codegen security` | ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚¹ã‚­ãƒ£ãƒ³ |
| `musubix test generate` | ãƒ†ã‚¹ãƒˆç”Ÿæˆ |
| `musubix trace matrix` | ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒãƒˆãƒªã‚¯ã‚¹ |
| `musubix trace validate` | ãƒªãƒ³ã‚¯æ¤œè¨¼ |
| `musubix trace impact` | å½±éŸ¿åˆ†æ |
| `musubix learn add-pattern` | ãƒ‘ã‚¿ãƒ¼ãƒ³ç™»éŒ² |
| `musubix learn feedback` | ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯è¨˜éŒ² |
| `musubix learn patterns` | ãƒ‘ã‚¿ãƒ¼ãƒ³ä¸€è¦§ |
| `musubix learn status` | å­¦ç¿’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ |
| `musubix learn export` | å­¦ç¿’ãƒ‡ãƒ¼ã‚¿ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ |

### ä»˜éŒ²C: ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
storage/
â”œâ”€â”€ specs/           # EARSè¦ä»¶å®šç¾©
â”‚   â””â”€â”€ REQ-*.md
â”œâ”€â”€ design/          # C4ãƒ¢ãƒ‡ãƒ«è¨­è¨ˆ
â”‚   â””â”€â”€ DES-*.md
â”œâ”€â”€ tasks/           # ã‚¿ã‚¹ã‚¯åˆ†è§£
â”‚   â””â”€â”€ TSK-*.md
â”œâ”€â”€ formal-verify/   # SMT-LIB2å½¢å¼æ¤œè¨¼
â”‚   â””â”€â”€ FV-*.smt2
â”œâ”€â”€ traceability/    # ãƒˆãƒ¬ãƒ¼ã‚µãƒ“ãƒªãƒ†ã‚£ãƒãƒˆãƒªã‚¯ã‚¹
â”‚   â””â”€â”€ trace-matrix.md
â””â”€â”€ learning/        # å­¦ç¿’ãƒ‡ãƒ¼ã‚¿
    â””â”€â”€ patterns-export.json
```

### ä»˜éŒ²D: EARSãƒ‘ã‚¿ãƒ¼ãƒ³æ—©è¦‹è¡¨

| ãƒ‘ã‚¿ãƒ¼ãƒ³ | æ§‹æ–‡ | ä¾‹ |
|---------|------|-----|
| Ubiquitous | `THE [system] SHALL [action]` | THE system SHALL encrypt all patient data |
| Event-driven | `WHEN [event], THE [system] SHALL [action]` | WHEN appointment is confirmed, THE system SHALL send notification |
| State-driven | `WHILE [state], THE [system] SHALL [action]` | WHILE user is logged in, THE system SHALL maintain session |
| Unwanted | `THE [system] SHALL NOT [action]` | THE system SHALL NOT allow duplicate bookings |
| Optional | `IF [condition], THEN THE [system] SHALL [action]` | IF cancellation is within 24h, THEN THE system SHALL reject |

---

**Document Version**: 1.0.0  
**Generated**: 2026-01-09  
**MUSUBIX Version**: 2.2.0  
**Project**: Medical Appointment System
